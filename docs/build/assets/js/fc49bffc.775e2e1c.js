"use strict";(globalThis.webpackChunkkafka_backup_docs=globalThis.webpackChunkkafka_backup_docs||[]).push([[4462],{8453:(e,r,s)=>{s.d(r,{R:()=>i,x:()=>o});var n=s(6540);const a={},c=n.createContext(a);function i(e){const r=n.useContext(c);return n.useMemo(function(){return"function"==typeof e?e(r):{...r,...e}},[r,e])}function o(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:i(e.components),n.createElement(c.Provider,{value:r},e.children)}},9346:(e,r,s)=>{s.r(r),s.d(r,{assets:()=>t,contentTitle:()=>o,default:()=>p,frontMatter:()=>i,metadata:()=>n,toc:()=>l});const n=JSON.parse('{"id":"reference/metrics","title":"Metrics Reference","description":"OSO Kafka Backup Prometheus metrics reference","source":"@site/docs/reference/metrics.md","sourceDirName":"reference","slug":"/reference/metrics","permalink":"/reference/metrics","draft":false,"unlisted":false,"editUrl":"https://github.com/osodevops/kafka-backup-docs/tree/main/docs/docs/reference/metrics.md","tags":[],"version":"current","sidebarPosition":5,"frontMatter":{"title":"Metrics Reference","description":"OSO Kafka Backup Prometheus metrics reference","sidebar_position":5},"sidebar":"docsSidebar","previous":{"title":"Error Codes","permalink":"/reference/error-codes"},"next":{"title":"Operator Overview","permalink":"/operator/"}}');var a=s(4848),c=s(8453);const i={title:"Metrics Reference",description:"OSO Kafka Backup Prometheus metrics reference",sidebar_position:5},o="Metrics Reference",t={},l=[{value:"Metrics Endpoint",id:"metrics-endpoint",level:2},{value:"CLI Metrics",id:"cli-metrics",level:2},{value:"Backup Metrics",id:"backup-metrics",level:2},{value:"kafka_backup_records_total",id:"kafka_backup_records_total",level:3},{value:"kafka_backup_bytes_total",id:"kafka_backup_bytes_total",level:3},{value:"kafka_backup_compressed_bytes_total",id:"kafka_backup_compressed_bytes_total",level:3},{value:"kafka_backup_segments_total",id:"kafka_backup_segments_total",level:3},{value:"kafka_backup_duration_seconds",id:"kafka_backup_duration_seconds",level:3},{value:"kafka_backup_throughput_records_per_second",id:"kafka_backup_throughput_records_per_second",level:3},{value:"kafka_backup_throughput_bytes_per_second",id:"kafka_backup_throughput_bytes_per_second",level:3},{value:"kafka_backup_lag_records",id:"kafka_backup_lag_records",level:3},{value:"kafka_backup_compression_ratio",id:"kafka_backup_compression_ratio",level:3},{value:"Restore Metrics",id:"restore-metrics",level:2},{value:"kafka_restore_records_total",id:"kafka_restore_records_total",level:3},{value:"kafka_restore_bytes_total",id:"kafka_restore_bytes_total",level:3},{value:"kafka_restore_duration_seconds",id:"kafka_restore_duration_seconds",level:3},{value:"kafka_restore_progress_percent",id:"kafka_restore_progress_percent",level:3},{value:"kafka_restore_throughput_records_per_second",id:"kafka_restore_throughput_records_per_second",level:3},{value:"kafka_restore_eta_seconds",id:"kafka_restore_eta_seconds",level:3},{value:"Offset Reset Metrics",id:"offset-reset-metrics",level:2},{value:"kafka_offset_reset_partitions_total",id:"kafka_offset_reset_partitions_total",level:3},{value:"kafka_offset_reset_duration_seconds",id:"kafka_offset_reset_duration_seconds",level:3},{value:"kafka_offset_reset_latency_seconds",id:"kafka_offset_reset_latency_seconds",level:3},{value:"Error Metrics",id:"error-metrics",level:2},{value:"kafka_backup_errors_total",id:"kafka_backup_errors_total",level:3},{value:"kafka_backup_retries_total",id:"kafka_backup_retries_total",level:3},{value:"Storage Metrics",id:"storage-metrics",level:2},{value:"kafka_backup_storage_write_bytes_total",id:"kafka_backup_storage_write_bytes_total",level:3},{value:"kafka_backup_storage_write_latency_seconds",id:"kafka_backup_storage_write_latency_seconds",level:3},{value:"kafka_backup_storage_read_bytes_total",id:"kafka_backup_storage_read_bytes_total",level:3},{value:"Operator Metrics",id:"operator-metrics",level:2},{value:"kafka_backup_operator_reconciliations_total",id:"kafka_backup_operator_reconciliations_total",level:3},{value:"kafka_backup_operator_reconciliation_errors_total",id:"kafka_backup_operator_reconciliation_errors_total",level:3},{value:"kafka_backup_operator_reconcile_duration_seconds",id:"kafka_backup_operator_reconcile_duration_seconds",level:3},{value:"kafka_backup_operator_managed_resources",id:"kafka_backup_operator_managed_resources",level:3},{value:"kafka_backup_operator_health",id:"kafka_backup_operator_health",level:3},{value:"Grafana Dashboard",id:"grafana-dashboard",level:2},{value:"Recommended Panels",id:"recommended-panels",level:3},{value:"Backup Overview",id:"backup-overview",level:4},{value:"Restore Progress",id:"restore-progress",level:4},{value:"Error Rates",id:"error-rates",level:4},{value:"Alert Rules",id:"alert-rules",level:3},{value:"Prometheus Scrape Config",id:"prometheus-scrape-config",level:2},{value:"ServiceMonitor (Prometheus Operator)",id:"servicemonitor-prometheus-operator",level:2}];function d(e){const r={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,c.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(r.header,{children:(0,a.jsx)(r.h1,{id:"metrics-reference",children:"Metrics Reference"})}),"\n",(0,a.jsx)(r.p,{children:"OSO Kafka Backup exposes Prometheus metrics for monitoring backup and restore operations."}),"\n",(0,a.jsx)(r.h2,{id:"metrics-endpoint",children:"Metrics Endpoint"}),"\n",(0,a.jsx)(r.p,{children:"When running as a service or operator, metrics are exposed at:"}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{children:"http://localhost:8080/metrics\n"})}),"\n",(0,a.jsx)(r.h2,{id:"cli-metrics",children:"CLI Metrics"}),"\n",(0,a.jsx)(r.p,{children:"The CLI reports metrics to stdout at the end of operations:"}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{children:"Backup completed successfully\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\nRecords:     2,456,789\nDuration:    5m 32s\nThroughput:  7,423 records/sec\nCompressed:  245 MB (4.9x ratio)\n"})}),"\n",(0,a.jsx)(r.hr,{}),"\n",(0,a.jsx)(r.h2,{id:"backup-metrics",children:"Backup Metrics"}),"\n",(0,a.jsx)(r.h3,{id:"kafka_backup_records_total",children:"kafka_backup_records_total"}),"\n",(0,a.jsxs)(r.p,{children:[(0,a.jsx)(r.strong,{children:"Type:"})," Counter"]}),"\n",(0,a.jsx)(r.p,{children:"Total number of records backed up."}),"\n",(0,a.jsx)(r.p,{children:(0,a.jsx)(r.strong,{children:"Labels:"})}),"\n",(0,a.jsxs)(r.ul,{children:["\n",(0,a.jsxs)(r.li,{children:[(0,a.jsx)(r.code,{children:"topic"})," - Topic name"]}),"\n",(0,a.jsxs)(r.li,{children:[(0,a.jsx)(r.code,{children:"partition"})," - Partition number"]}),"\n",(0,a.jsxs)(r.li,{children:[(0,a.jsx)(r.code,{children:"backup_id"})," - Backup identifier"]}),"\n"]}),"\n",(0,a.jsx)(r.p,{children:(0,a.jsx)(r.strong,{children:"Example:"})}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{children:'kafka_backup_records_total{topic="orders",partition="0",backup_id="daily-001"} 150234\n'})}),"\n",(0,a.jsx)(r.h3,{id:"kafka_backup_bytes_total",children:"kafka_backup_bytes_total"}),"\n",(0,a.jsxs)(r.p,{children:[(0,a.jsx)(r.strong,{children:"Type:"})," Counter"]}),"\n",(0,a.jsx)(r.p,{children:"Total bytes backed up (uncompressed)."}),"\n",(0,a.jsx)(r.p,{children:(0,a.jsx)(r.strong,{children:"Labels:"})}),"\n",(0,a.jsxs)(r.ul,{children:["\n",(0,a.jsxs)(r.li,{children:[(0,a.jsx)(r.code,{children:"topic"})," - Topic name"]}),"\n",(0,a.jsxs)(r.li,{children:[(0,a.jsx)(r.code,{children:"partition"})," - Partition number"]}),"\n",(0,a.jsxs)(r.li,{children:[(0,a.jsx)(r.code,{children:"backup_id"})," - Backup identifier"]}),"\n"]}),"\n",(0,a.jsx)(r.p,{children:(0,a.jsx)(r.strong,{children:"Example:"})}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{children:'kafka_backup_bytes_total{topic="orders",partition="0",backup_id="daily-001"} 52428800\n'})}),"\n",(0,a.jsx)(r.h3,{id:"kafka_backup_compressed_bytes_total",children:"kafka_backup_compressed_bytes_total"}),"\n",(0,a.jsxs)(r.p,{children:[(0,a.jsx)(r.strong,{children:"Type:"})," Counter"]}),"\n",(0,a.jsx)(r.p,{children:"Total bytes written to storage (compressed)."}),"\n",(0,a.jsx)(r.p,{children:(0,a.jsx)(r.strong,{children:"Labels:"})}),"\n",(0,a.jsxs)(r.ul,{children:["\n",(0,a.jsxs)(r.li,{children:[(0,a.jsx)(r.code,{children:"topic"})," - Topic name"]}),"\n",(0,a.jsxs)(r.li,{children:[(0,a.jsx)(r.code,{children:"backup_id"})," - Backup identifier"]}),"\n"]}),"\n",(0,a.jsx)(r.p,{children:(0,a.jsx)(r.strong,{children:"Example:"})}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{children:'kafka_backup_compressed_bytes_total{topic="orders",backup_id="daily-001"} 10485760\n'})}),"\n",(0,a.jsx)(r.h3,{id:"kafka_backup_segments_total",children:"kafka_backup_segments_total"}),"\n",(0,a.jsxs)(r.p,{children:[(0,a.jsx)(r.strong,{children:"Type:"})," Counter"]}),"\n",(0,a.jsx)(r.p,{children:"Total number of segment files created."}),"\n",(0,a.jsx)(r.p,{children:(0,a.jsx)(r.strong,{children:"Labels:"})}),"\n",(0,a.jsxs)(r.ul,{children:["\n",(0,a.jsxs)(r.li,{children:[(0,a.jsx)(r.code,{children:"topic"})," - Topic name"]}),"\n",(0,a.jsxs)(r.li,{children:[(0,a.jsx)(r.code,{children:"partition"})," - Partition number"]}),"\n",(0,a.jsxs)(r.li,{children:[(0,a.jsx)(r.code,{children:"backup_id"})," - Backup identifier"]}),"\n"]}),"\n",(0,a.jsx)(r.h3,{id:"kafka_backup_duration_seconds",children:"kafka_backup_duration_seconds"}),"\n",(0,a.jsxs)(r.p,{children:[(0,a.jsx)(r.strong,{children:"Type:"})," Histogram"]}),"\n",(0,a.jsx)(r.p,{children:"Backup operation duration in seconds."}),"\n",(0,a.jsx)(r.p,{children:(0,a.jsx)(r.strong,{children:"Labels:"})}),"\n",(0,a.jsxs)(r.ul,{children:["\n",(0,a.jsxs)(r.li,{children:[(0,a.jsx)(r.code,{children:"backup_id"})," - Backup identifier"]}),"\n",(0,a.jsxs)(r.li,{children:[(0,a.jsx)(r.code,{children:"status"})," - ",(0,a.jsx)(r.code,{children:"success"})," or ",(0,a.jsx)(r.code,{children:"failure"})]}),"\n"]}),"\n",(0,a.jsxs)(r.p,{children:[(0,a.jsx)(r.strong,{children:"Buckets:"})," 1, 5, 15, 30, 60, 120, 300, 600, 1800, 3600"]}),"\n",(0,a.jsx)(r.p,{children:(0,a.jsx)(r.strong,{children:"Example:"})}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{children:'kafka_backup_duration_seconds_bucket{backup_id="daily-001",status="success",le="300"} 1\nkafka_backup_duration_seconds_sum{backup_id="daily-001",status="success"} 332.5\nkafka_backup_duration_seconds_count{backup_id="daily-001",status="success"} 1\n'})}),"\n",(0,a.jsx)(r.h3,{id:"kafka_backup_throughput_records_per_second",children:"kafka_backup_throughput_records_per_second"}),"\n",(0,a.jsxs)(r.p,{children:[(0,a.jsx)(r.strong,{children:"Type:"})," Gauge"]}),"\n",(0,a.jsx)(r.p,{children:"Current backup throughput (records per second)."}),"\n",(0,a.jsx)(r.p,{children:(0,a.jsx)(r.strong,{children:"Labels:"})}),"\n",(0,a.jsxs)(r.ul,{children:["\n",(0,a.jsxs)(r.li,{children:[(0,a.jsx)(r.code,{children:"backup_id"})," - Backup identifier"]}),"\n"]}),"\n",(0,a.jsx)(r.h3,{id:"kafka_backup_throughput_bytes_per_second",children:"kafka_backup_throughput_bytes_per_second"}),"\n",(0,a.jsxs)(r.p,{children:[(0,a.jsx)(r.strong,{children:"Type:"})," Gauge"]}),"\n",(0,a.jsx)(r.p,{children:"Current backup throughput (bytes per second)."}),"\n",(0,a.jsx)(r.p,{children:(0,a.jsx)(r.strong,{children:"Labels:"})}),"\n",(0,a.jsxs)(r.ul,{children:["\n",(0,a.jsxs)(r.li,{children:[(0,a.jsx)(r.code,{children:"backup_id"})," - Backup identifier"]}),"\n"]}),"\n",(0,a.jsx)(r.h3,{id:"kafka_backup_lag_records",children:"kafka_backup_lag_records"}),"\n",(0,a.jsxs)(r.p,{children:[(0,a.jsx)(r.strong,{children:"Type:"})," Gauge"]}),"\n",(0,a.jsx)(r.p,{children:"Number of records behind the high watermark."}),"\n",(0,a.jsx)(r.p,{children:(0,a.jsx)(r.strong,{children:"Labels:"})}),"\n",(0,a.jsxs)(r.ul,{children:["\n",(0,a.jsxs)(r.li,{children:[(0,a.jsx)(r.code,{children:"topic"})," - Topic name"]}),"\n",(0,a.jsxs)(r.li,{children:[(0,a.jsx)(r.code,{children:"partition"})," - Partition number"]}),"\n",(0,a.jsxs)(r.li,{children:[(0,a.jsx)(r.code,{children:"backup_id"})," - Backup identifier"]}),"\n"]}),"\n",(0,a.jsx)(r.h3,{id:"kafka_backup_compression_ratio",children:"kafka_backup_compression_ratio"}),"\n",(0,a.jsxs)(r.p,{children:[(0,a.jsx)(r.strong,{children:"Type:"})," Gauge"]}),"\n",(0,a.jsx)(r.p,{children:"Compression ratio (uncompressed / compressed)."}),"\n",(0,a.jsx)(r.p,{children:(0,a.jsx)(r.strong,{children:"Labels:"})}),"\n",(0,a.jsxs)(r.ul,{children:["\n",(0,a.jsxs)(r.li,{children:[(0,a.jsx)(r.code,{children:"backup_id"})," - Backup identifier"]}),"\n",(0,a.jsxs)(r.li,{children:[(0,a.jsx)(r.code,{children:"algorithm"})," - Compression algorithm (zstd, lz4, none)"]}),"\n"]}),"\n",(0,a.jsx)(r.p,{children:(0,a.jsx)(r.strong,{children:"Example:"})}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{children:'kafka_backup_compression_ratio{backup_id="daily-001",algorithm="zstd"} 4.9\n'})}),"\n",(0,a.jsx)(r.hr,{}),"\n",(0,a.jsx)(r.h2,{id:"restore-metrics",children:"Restore Metrics"}),"\n",(0,a.jsx)(r.h3,{id:"kafka_restore_records_total",children:"kafka_restore_records_total"}),"\n",(0,a.jsxs)(r.p,{children:[(0,a.jsx)(r.strong,{children:"Type:"})," Counter"]}),"\n",(0,a.jsx)(r.p,{children:"Total number of records restored."}),"\n",(0,a.jsx)(r.p,{children:(0,a.jsx)(r.strong,{children:"Labels:"})}),"\n",(0,a.jsxs)(r.ul,{children:["\n",(0,a.jsxs)(r.li,{children:[(0,a.jsx)(r.code,{children:"topic"})," - Target topic name"]}),"\n",(0,a.jsxs)(r.li,{children:[(0,a.jsx)(r.code,{children:"partition"})," - Target partition"]}),"\n",(0,a.jsxs)(r.li,{children:[(0,a.jsx)(r.code,{children:"backup_id"})," - Source backup identifier"]}),"\n"]}),"\n",(0,a.jsx)(r.h3,{id:"kafka_restore_bytes_total",children:"kafka_restore_bytes_total"}),"\n",(0,a.jsxs)(r.p,{children:[(0,a.jsx)(r.strong,{children:"Type:"})," Counter"]}),"\n",(0,a.jsx)(r.p,{children:"Total bytes restored."}),"\n",(0,a.jsx)(r.p,{children:(0,a.jsx)(r.strong,{children:"Labels:"})}),"\n",(0,a.jsxs)(r.ul,{children:["\n",(0,a.jsxs)(r.li,{children:[(0,a.jsx)(r.code,{children:"topic"})," - Target topic name"]}),"\n",(0,a.jsxs)(r.li,{children:[(0,a.jsx)(r.code,{children:"backup_id"})," - Source backup identifier"]}),"\n"]}),"\n",(0,a.jsx)(r.h3,{id:"kafka_restore_duration_seconds",children:"kafka_restore_duration_seconds"}),"\n",(0,a.jsxs)(r.p,{children:[(0,a.jsx)(r.strong,{children:"Type:"})," Histogram"]}),"\n",(0,a.jsx)(r.p,{children:"Restore operation duration."}),"\n",(0,a.jsx)(r.p,{children:(0,a.jsx)(r.strong,{children:"Labels:"})}),"\n",(0,a.jsxs)(r.ul,{children:["\n",(0,a.jsxs)(r.li,{children:[(0,a.jsx)(r.code,{children:"backup_id"})," - Source backup identifier"]}),"\n",(0,a.jsxs)(r.li,{children:[(0,a.jsx)(r.code,{children:"status"})," - ",(0,a.jsx)(r.code,{children:"success"})," or ",(0,a.jsx)(r.code,{children:"failure"})]}),"\n"]}),"\n",(0,a.jsxs)(r.p,{children:[(0,a.jsx)(r.strong,{children:"Buckets:"})," 1, 5, 15, 30, 60, 120, 300, 600, 1800, 3600"]}),"\n",(0,a.jsx)(r.h3,{id:"kafka_restore_progress_percent",children:"kafka_restore_progress_percent"}),"\n",(0,a.jsxs)(r.p,{children:[(0,a.jsx)(r.strong,{children:"Type:"})," Gauge"]}),"\n",(0,a.jsx)(r.p,{children:"Restore progress percentage (0-100)."}),"\n",(0,a.jsx)(r.p,{children:(0,a.jsx)(r.strong,{children:"Labels:"})}),"\n",(0,a.jsxs)(r.ul,{children:["\n",(0,a.jsxs)(r.li,{children:[(0,a.jsx)(r.code,{children:"backup_id"})," - Source backup identifier"]}),"\n"]}),"\n",(0,a.jsx)(r.h3,{id:"kafka_restore_throughput_records_per_second",children:"kafka_restore_throughput_records_per_second"}),"\n",(0,a.jsxs)(r.p,{children:[(0,a.jsx)(r.strong,{children:"Type:"})," Gauge"]}),"\n",(0,a.jsx)(r.p,{children:"Current restore throughput."}),"\n",(0,a.jsx)(r.p,{children:(0,a.jsx)(r.strong,{children:"Labels:"})}),"\n",(0,a.jsxs)(r.ul,{children:["\n",(0,a.jsxs)(r.li,{children:[(0,a.jsx)(r.code,{children:"backup_id"})," - Source backup identifier"]}),"\n"]}),"\n",(0,a.jsx)(r.h3,{id:"kafka_restore_eta_seconds",children:"kafka_restore_eta_seconds"}),"\n",(0,a.jsxs)(r.p,{children:[(0,a.jsx)(r.strong,{children:"Type:"})," Gauge"]}),"\n",(0,a.jsx)(r.p,{children:"Estimated time remaining for restore."}),"\n",(0,a.jsx)(r.p,{children:(0,a.jsx)(r.strong,{children:"Labels:"})}),"\n",(0,a.jsxs)(r.ul,{children:["\n",(0,a.jsxs)(r.li,{children:[(0,a.jsx)(r.code,{children:"backup_id"})," - Source backup identifier"]}),"\n"]}),"\n",(0,a.jsx)(r.hr,{}),"\n",(0,a.jsx)(r.h2,{id:"offset-reset-metrics",children:"Offset Reset Metrics"}),"\n",(0,a.jsx)(r.h3,{id:"kafka_offset_reset_partitions_total",children:"kafka_offset_reset_partitions_total"}),"\n",(0,a.jsxs)(r.p,{children:[(0,a.jsx)(r.strong,{children:"Type:"})," Counter"]}),"\n",(0,a.jsx)(r.p,{children:"Total partitions where offsets were reset."}),"\n",(0,a.jsx)(r.p,{children:(0,a.jsx)(r.strong,{children:"Labels:"})}),"\n",(0,a.jsxs)(r.ul,{children:["\n",(0,a.jsxs)(r.li,{children:[(0,a.jsx)(r.code,{children:"consumer_group"})," - Consumer group name"]}),"\n",(0,a.jsxs)(r.li,{children:[(0,a.jsx)(r.code,{children:"status"})," - ",(0,a.jsx)(r.code,{children:"success"})," or ",(0,a.jsx)(r.code,{children:"failure"})]}),"\n"]}),"\n",(0,a.jsx)(r.h3,{id:"kafka_offset_reset_duration_seconds",children:"kafka_offset_reset_duration_seconds"}),"\n",(0,a.jsxs)(r.p,{children:[(0,a.jsx)(r.strong,{children:"Type:"})," Histogram"]}),"\n",(0,a.jsx)(r.p,{children:"Offset reset operation duration."}),"\n",(0,a.jsx)(r.p,{children:(0,a.jsx)(r.strong,{children:"Labels:"})}),"\n",(0,a.jsxs)(r.ul,{children:["\n",(0,a.jsxs)(r.li,{children:[(0,a.jsx)(r.code,{children:"consumer_group"})," - Consumer group name"]}),"\n",(0,a.jsxs)(r.li,{children:[(0,a.jsx)(r.code,{children:"status"})," - ",(0,a.jsx)(r.code,{children:"success"})," or ",(0,a.jsx)(r.code,{children:"failure"})]}),"\n"]}),"\n",(0,a.jsxs)(r.p,{children:[(0,a.jsx)(r.strong,{children:"Buckets:"})," 0.5, 1, 2.5, 5, 10, 30, 60, 120"]}),"\n",(0,a.jsx)(r.h3,{id:"kafka_offset_reset_latency_seconds",children:"kafka_offset_reset_latency_seconds"}),"\n",(0,a.jsxs)(r.p,{children:[(0,a.jsx)(r.strong,{children:"Type:"})," Histogram"]}),"\n",(0,a.jsx)(r.p,{children:"Per-partition offset reset latency."}),"\n",(0,a.jsx)(r.p,{children:(0,a.jsx)(r.strong,{children:"Labels:"})}),"\n",(0,a.jsxs)(r.ul,{children:["\n",(0,a.jsxs)(r.li,{children:[(0,a.jsx)(r.code,{children:"consumer_group"})," - Consumer group name"]}),"\n",(0,a.jsxs)(r.li,{children:[(0,a.jsx)(r.code,{children:"quantile"})," - p50, p90, p99"]}),"\n"]}),"\n",(0,a.jsx)(r.hr,{}),"\n",(0,a.jsx)(r.h2,{id:"error-metrics",children:"Error Metrics"}),"\n",(0,a.jsx)(r.h3,{id:"kafka_backup_errors_total",children:"kafka_backup_errors_total"}),"\n",(0,a.jsxs)(r.p,{children:[(0,a.jsx)(r.strong,{children:"Type:"})," Counter"]}),"\n",(0,a.jsx)(r.p,{children:"Total number of errors encountered."}),"\n",(0,a.jsx)(r.p,{children:(0,a.jsx)(r.strong,{children:"Labels:"})}),"\n",(0,a.jsxs)(r.ul,{children:["\n",(0,a.jsxs)(r.li,{children:[(0,a.jsx)(r.code,{children:"operation"})," - ",(0,a.jsx)(r.code,{children:"backup"}),", ",(0,a.jsx)(r.code,{children:"restore"}),", ",(0,a.jsx)(r.code,{children:"validate"}),", ",(0,a.jsx)(r.code,{children:"offset_reset"})]}),"\n",(0,a.jsxs)(r.li,{children:[(0,a.jsx)(r.code,{children:"error_type"})," - Error category (see ",(0,a.jsx)(r.a,{href:"./error-codes",children:"Error Codes"}),")"]}),"\n"]}),"\n",(0,a.jsx)(r.p,{children:(0,a.jsx)(r.strong,{children:"Example:"})}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{children:'kafka_backup_errors_total{operation="backup",error_type="KAFKA_CONNECTION_FAILED"} 2\n'})}),"\n",(0,a.jsx)(r.h3,{id:"kafka_backup_retries_total",children:"kafka_backup_retries_total"}),"\n",(0,a.jsxs)(r.p,{children:[(0,a.jsx)(r.strong,{children:"Type:"})," Counter"]}),"\n",(0,a.jsx)(r.p,{children:"Total number of retry attempts."}),"\n",(0,a.jsx)(r.p,{children:(0,a.jsx)(r.strong,{children:"Labels:"})}),"\n",(0,a.jsxs)(r.ul,{children:["\n",(0,a.jsxs)(r.li,{children:[(0,a.jsx)(r.code,{children:"operation"})," - Operation type"]}),"\n",(0,a.jsxs)(r.li,{children:[(0,a.jsx)(r.code,{children:"reason"})," - Retry reason"]}),"\n"]}),"\n",(0,a.jsx)(r.hr,{}),"\n",(0,a.jsx)(r.h2,{id:"storage-metrics",children:"Storage Metrics"}),"\n",(0,a.jsx)(r.h3,{id:"kafka_backup_storage_write_bytes_total",children:"kafka_backup_storage_write_bytes_total"}),"\n",(0,a.jsxs)(r.p,{children:[(0,a.jsx)(r.strong,{children:"Type:"})," Counter"]}),"\n",(0,a.jsx)(r.p,{children:"Total bytes written to storage."}),"\n",(0,a.jsx)(r.p,{children:(0,a.jsx)(r.strong,{children:"Labels:"})}),"\n",(0,a.jsxs)(r.ul,{children:["\n",(0,a.jsxs)(r.li,{children:[(0,a.jsx)(r.code,{children:"backend"})," - Storage backend (filesystem, s3, azure, gcs)"]}),"\n",(0,a.jsxs)(r.li,{children:[(0,a.jsx)(r.code,{children:"backup_id"})," - Backup identifier"]}),"\n"]}),"\n",(0,a.jsx)(r.h3,{id:"kafka_backup_storage_write_latency_seconds",children:"kafka_backup_storage_write_latency_seconds"}),"\n",(0,a.jsxs)(r.p,{children:[(0,a.jsx)(r.strong,{children:"Type:"})," Histogram"]}),"\n",(0,a.jsx)(r.p,{children:"Storage write latency."}),"\n",(0,a.jsx)(r.p,{children:(0,a.jsx)(r.strong,{children:"Labels:"})}),"\n",(0,a.jsxs)(r.ul,{children:["\n",(0,a.jsxs)(r.li,{children:[(0,a.jsx)(r.code,{children:"backend"})," - Storage backend"]}),"\n",(0,a.jsxs)(r.li,{children:[(0,a.jsx)(r.code,{children:"operation"})," - ",(0,a.jsx)(r.code,{children:"segment"}),", ",(0,a.jsx)(r.code,{children:"manifest"}),", ",(0,a.jsx)(r.code,{children:"checkpoint"})]}),"\n"]}),"\n",(0,a.jsxs)(r.p,{children:[(0,a.jsx)(r.strong,{children:"Buckets:"})," 0.01, 0.05, 0.1, 0.25, 0.5, 1, 2.5, 5, 10"]}),"\n",(0,a.jsx)(r.h3,{id:"kafka_backup_storage_read_bytes_total",children:"kafka_backup_storage_read_bytes_total"}),"\n",(0,a.jsxs)(r.p,{children:[(0,a.jsx)(r.strong,{children:"Type:"})," Counter"]}),"\n",(0,a.jsx)(r.p,{children:"Total bytes read from storage."}),"\n",(0,a.jsx)(r.p,{children:(0,a.jsx)(r.strong,{children:"Labels:"})}),"\n",(0,a.jsxs)(r.ul,{children:["\n",(0,a.jsxs)(r.li,{children:[(0,a.jsx)(r.code,{children:"backend"})," - Storage backend"]}),"\n",(0,a.jsxs)(r.li,{children:[(0,a.jsx)(r.code,{children:"backup_id"})," - Backup identifier"]}),"\n"]}),"\n",(0,a.jsx)(r.hr,{}),"\n",(0,a.jsx)(r.h2,{id:"operator-metrics",children:"Operator Metrics"}),"\n",(0,a.jsx)(r.p,{children:"When running as a Kubernetes operator, additional metrics are exposed:"}),"\n",(0,a.jsx)(r.h3,{id:"kafka_backup_operator_reconciliations_total",children:"kafka_backup_operator_reconciliations_total"}),"\n",(0,a.jsxs)(r.p,{children:[(0,a.jsx)(r.strong,{children:"Type:"})," Counter"]}),"\n",(0,a.jsx)(r.p,{children:"Total reconciliation loops."}),"\n",(0,a.jsx)(r.p,{children:(0,a.jsx)(r.strong,{children:"Labels:"})}),"\n",(0,a.jsxs)(r.ul,{children:["\n",(0,a.jsxs)(r.li,{children:[(0,a.jsx)(r.code,{children:"kind"})," - Resource kind (KafkaBackup, KafkaRestore, etc.)"]}),"\n",(0,a.jsxs)(r.li,{children:[(0,a.jsx)(r.code,{children:"result"})," - ",(0,a.jsx)(r.code,{children:"success"}),", ",(0,a.jsx)(r.code,{children:"failure"}),", ",(0,a.jsx)(r.code,{children:"requeue"})]}),"\n"]}),"\n",(0,a.jsx)(r.h3,{id:"kafka_backup_operator_reconciliation_errors_total",children:"kafka_backup_operator_reconciliation_errors_total"}),"\n",(0,a.jsxs)(r.p,{children:[(0,a.jsx)(r.strong,{children:"Type:"})," Counter"]}),"\n",(0,a.jsx)(r.p,{children:"Total reconciliation errors."}),"\n",(0,a.jsx)(r.p,{children:(0,a.jsx)(r.strong,{children:"Labels:"})}),"\n",(0,a.jsxs)(r.ul,{children:["\n",(0,a.jsxs)(r.li,{children:[(0,a.jsx)(r.code,{children:"kind"})," - Resource kind"]}),"\n"]}),"\n",(0,a.jsx)(r.h3,{id:"kafka_backup_operator_reconcile_duration_seconds",children:"kafka_backup_operator_reconcile_duration_seconds"}),"\n",(0,a.jsxs)(r.p,{children:[(0,a.jsx)(r.strong,{children:"Type:"})," Histogram"]}),"\n",(0,a.jsx)(r.p,{children:"Reconciliation loop duration."}),"\n",(0,a.jsx)(r.p,{children:(0,a.jsx)(r.strong,{children:"Labels:"})}),"\n",(0,a.jsxs)(r.ul,{children:["\n",(0,a.jsxs)(r.li,{children:[(0,a.jsx)(r.code,{children:"kind"})," - Resource kind"]}),"\n"]}),"\n",(0,a.jsxs)(r.p,{children:[(0,a.jsx)(r.strong,{children:"Buckets:"})," 0.01, 0.05, 0.1, 0.25, 0.5, 1, 2.5, 5, 10"]}),"\n",(0,a.jsx)(r.h3,{id:"kafka_backup_operator_managed_resources",children:"kafka_backup_operator_managed_resources"}),"\n",(0,a.jsxs)(r.p,{children:[(0,a.jsx)(r.strong,{children:"Type:"})," Gauge"]}),"\n",(0,a.jsx)(r.p,{children:"Number of managed resources by type."}),"\n",(0,a.jsx)(r.p,{children:(0,a.jsx)(r.strong,{children:"Labels:"})}),"\n",(0,a.jsxs)(r.ul,{children:["\n",(0,a.jsxs)(r.li,{children:[(0,a.jsx)(r.code,{children:"kind"})," - Resource kind"]}),"\n"]}),"\n",(0,a.jsx)(r.h3,{id:"kafka_backup_operator_health",children:"kafka_backup_operator_health"}),"\n",(0,a.jsxs)(r.p,{children:[(0,a.jsx)(r.strong,{children:"Type:"})," Gauge"]}),"\n",(0,a.jsx)(r.p,{children:"Operator health status (1 = healthy, 0 = unhealthy)."}),"\n",(0,a.jsx)(r.hr,{}),"\n",(0,a.jsx)(r.h2,{id:"grafana-dashboard",children:"Grafana Dashboard"}),"\n",(0,a.jsx)(r.h3,{id:"recommended-panels",children:"Recommended Panels"}),"\n",(0,a.jsx)(r.h4,{id:"backup-overview",children:"Backup Overview"}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-promql",children:"# Backup throughput\nrate(kafka_backup_records_total[5m])\n\n# Compression ratio\nkafka_backup_compression_ratio\n\n# Active backups\ncount(kafka_backup_throughput_records_per_second > 0)\n"})}),"\n",(0,a.jsx)(r.h4,{id:"restore-progress",children:"Restore Progress"}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-promql",children:"# Progress percentage\nkafka_restore_progress_percent\n\n# ETA\nkafka_restore_eta_seconds\n\n# Throughput\nkafka_restore_throughput_records_per_second\n"})}),"\n",(0,a.jsx)(r.h4,{id:"error-rates",children:"Error Rates"}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-promql",children:"# Error rate\nrate(kafka_backup_errors_total[5m])\n\n# Retry rate\nrate(kafka_backup_retries_total[5m])\n"})}),"\n",(0,a.jsx)(r.h3,{id:"alert-rules",children:"Alert Rules"}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-yaml",children:'groups:\n  - name: kafka-backup\n    rules:\n      - alert: BackupFailed\n        expr: increase(kafka_backup_errors_total{operation="backup"}[1h]) > 0\n        for: 5m\n        labels:\n          severity: critical\n        annotations:\n          summary: "Kafka backup failed"\n          description: "Backup {{ $labels.backup_id }} has failed"\n\n      - alert: BackupLagging\n        expr: kafka_backup_lag_records > 100000\n        for: 10m\n        labels:\n          severity: warning\n        annotations:\n          summary: "Backup is lagging"\n          description: "Backup {{ $labels.backup_id }} is {{ $value }} records behind"\n\n      - alert: LowCompressionRatio\n        expr: kafka_backup_compression_ratio < 2\n        for: 30m\n        labels:\n          severity: warning\n        annotations:\n          summary: "Low compression ratio"\n          description: "Compression ratio is only {{ $value }}x"\n'})}),"\n",(0,a.jsx)(r.hr,{}),"\n",(0,a.jsx)(r.h2,{id:"prometheus-scrape-config",children:"Prometheus Scrape Config"}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-yaml",children:"scrape_configs:\n  - job_name: 'kafka-backup'\n    static_configs:\n      - targets: ['kafka-backup:8080']\n    metrics_path: /metrics\n    scrape_interval: 15s\n\n  - job_name: 'kafka-backup-operator'\n    kubernetes_sd_configs:\n      - role: pod\n    relabel_configs:\n      - source_labels: [__meta_kubernetes_pod_label_app]\n        regex: kafka-backup-operator\n        action: keep\n"})}),"\n",(0,a.jsx)(r.h2,{id:"servicemonitor-prometheus-operator",children:"ServiceMonitor (Prometheus Operator)"}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-yaml",children:"apiVersion: monitoring.coreos.com/v1\nkind: ServiceMonitor\nmetadata:\n  name: kafka-backup-operator\n  labels:\n    release: prometheus\nspec:\n  selector:\n    matchLabels:\n      app: kafka-backup-operator\n  endpoints:\n    - port: metrics\n      interval: 15s\n      path: /metrics\n"})})]})}function p(e={}){const{wrapper:r}={...(0,c.R)(),...e.components};return r?(0,a.jsx)(r,{...e,children:(0,a.jsx)(d,{...e})}):d(e)}}}]);