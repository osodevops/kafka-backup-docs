"use strict";(globalThis.webpackChunkkafka_backup_docs=globalThis.webpackChunkkafka_backup_docs||[]).push([[6494],{2835:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>d,contentTitle:()=>l,default:()=>h,frontMatter:()=>a,metadata:()=>i,toc:()=>c});const i=JSON.parse('{"id":"enterprise/encryption","title":"Field-Level Encryption","description":"Encrypt sensitive fields in Kafka messages during backup","source":"@site/docs/enterprise/encryption.md","sourceDirName":"enterprise","slug":"/enterprise/encryption","permalink":"/enterprise/encryption","draft":false,"unlisted":false,"editUrl":"https://github.com/osodevops/kafka-backup-docs/tree/main/docs/docs/enterprise/encryption.md","tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"title":"Field-Level Encryption","description":"Encrypt sensitive fields in Kafka messages during backup","sidebar_position":2},"sidebar":"docsSidebar","previous":{"title":"Enterprise Overview","permalink":"/enterprise/"},"next":{"title":"RBAC","permalink":"/enterprise/rbac"}}');var s=r(4848),t=r(8453);const a={title:"Field-Level Encryption",description:"Encrypt sensitive fields in Kafka messages during backup",sidebar_position:2},l="Field-Level Encryption",d={},c=[{value:"Overview",id:"overview",level:2},{value:"Configuration",id:"configuration",level:2},{value:"Basic Encryption",id:"basic-encryption",level:3},{value:"Key Providers",id:"key-providers",level:3},{value:"Environment Variable",id:"environment-variable",level:4},{value:"AWS KMS",id:"aws-kms",level:4},{value:"Azure Key Vault",id:"azure-key-vault",level:4},{value:"HashiCorp Vault",id:"hashicorp-vault",level:4},{value:"File-Based",id:"file-based",level:4},{value:"Field Selection",id:"field-selection",level:2},{value:"JSONPath Syntax",id:"jsonpath-syntax",level:3},{value:"Examples",id:"examples",level:3},{value:"Encryption Algorithms",id:"encryption-algorithms",level:2},{value:"Supported Algorithms",id:"supported-algorithms",level:3},{value:"Algorithm Configuration",id:"algorithm-configuration",level:3},{value:"Topic-Specific Encryption",id:"topic-specific-encryption",level:2},{value:"Restore Behavior",id:"restore-behavior",level:2},{value:"Decryption on Restore",id:"decryption-on-restore",level:3},{value:"Keep Encrypted",id:"keep-encrypted",level:3},{value:"Re-encrypt with Different Key",id:"re-encrypt-with-different-key",level:3},{value:"Key Rotation",id:"key-rotation",level:2},{value:"Automatic Key Rotation",id:"automatic-key-rotation",level:3},{value:"Manual Key Rotation",id:"manual-key-rotation",level:3},{value:"Data Masking",id:"data-masking",level:2},{value:"Masking Types",id:"masking-types",level:3},{value:"Custom Masking",id:"custom-masking",level:3},{value:"Kubernetes Configuration",id:"kubernetes-configuration",level:2},{value:"Secrets for Encryption Keys",id:"secrets-for-encryption-keys",level:3},{value:"Operator Configuration",id:"operator-configuration",level:3},{value:"Verification",id:"verification",level:2},{value:"Verify Encryption",id:"verify-encryption",level:3},{value:"Sample Encrypted Data",id:"sample-encrypted-data",level:3},{value:"Performance Impact",id:"performance-impact",level:2},{value:"Best Practices",id:"best-practices",level:2},{value:"Troubleshooting",id:"troubleshooting",level:2},{value:"Decryption Failed",id:"decryption-failed",level:3},{value:"KMS Access Denied",id:"kms-access-denied",level:3},{value:"Next Steps",id:"next-steps",level:2}];function o(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"field-level-encryption",children:"Field-Level Encryption"})}),"\n",(0,s.jsx)(n.p,{children:"OSO Kafka Backup Enterprise provides field-level encryption to protect sensitive data within messages while keeping the overall message structure readable."}),"\n",(0,s.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,s.jsx)(n.p,{children:"Field-level encryption allows you to:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Encrypt specific fields (SSN, credit card, etc.)"}),"\n",(0,s.jsx)(n.li,{children:"Keep metadata and non-sensitive fields readable"}),"\n",(0,s.jsx)(n.li,{children:"Decrypt on restore when needed"}),"\n",(0,s.jsx)(n.li,{children:"Comply with data protection regulations"}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:'Original Message:\n{\n  "order_id": "12345",\n  "customer": {\n    "name": "John Doe",\n    "email": "john@example.com",    \u2190 Encrypt\n    "ssn": "123-45-6789"            \u2190 Encrypt\n  },\n  "amount": 99.99\n}\n\nEncrypted Backup:\n{\n  "order_id": "12345",\n  "customer": {\n    "name": "John Doe",\n    "email": "ENC[AES256:abc123...]",\n    "ssn": "ENC[AES256:def456...]"\n  },\n  "amount": 99.99\n}\n'})}),"\n",(0,s.jsx)(n.h2,{id:"configuration",children:"Configuration"}),"\n",(0,s.jsx)(n.h3,{id:"basic-encryption",children:"Basic Encryption"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:'enterprise:\n  encryption:\n    enabled: true\n    key_provider: env\n    key_env_var: ENCRYPTION_KEY\n\n    fields:\n      - path: "$.customer.ssn"\n      - path: "$.customer.email"\n      - path: "$.payment.card_number"\n'})}),"\n",(0,s.jsx)(n.h3,{id:"key-providers",children:"Key Providers"}),"\n",(0,s.jsx)(n.h4,{id:"environment-variable",children:"Environment Variable"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:'enterprise:\n  encryption:\n    key_provider: env\n    key_env_var: ENCRYPTION_KEY\n\n# Set the key (32 bytes for AES-256)\nexport ENCRYPTION_KEY="your-32-byte-encryption-key-here"\n'})}),"\n",(0,s.jsx)(n.h4,{id:"aws-kms",children:"AWS KMS"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:'enterprise:\n  encryption:\n    key_provider: aws-kms\n    kms_key_id: "arn:aws:kms:us-west-2:123456789:key/12345678-1234-1234-1234-123456789012"\n    kms_region: us-west-2\n'})}),"\n",(0,s.jsx)(n.h4,{id:"azure-key-vault",children:"Azure Key Vault"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:'enterprise:\n  encryption:\n    key_provider: azure-keyvault\n    keyvault_url: "https://myvault.vault.azure.net"\n    keyvault_key_name: "kafka-backup-key"\n'})}),"\n",(0,s.jsx)(n.h4,{id:"hashicorp-vault",children:"HashiCorp Vault"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:'enterprise:\n  encryption:\n    key_provider: hashicorp-vault\n    vault_addr: "https://vault.example.com:8200"\n    vault_path: "secret/data/kafka-backup"\n    vault_key_name: "encryption_key"\n'})}),"\n",(0,s.jsx)(n.h4,{id:"file-based",children:"File-Based"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"enterprise:\n  encryption:\n    key_provider: file\n    key_file: /etc/kafka-backup/encryption.key\n\n# Key file should contain raw key bytes or base64\n"})}),"\n",(0,s.jsx)(n.h2,{id:"field-selection",children:"Field Selection"}),"\n",(0,s.jsx)(n.h3,{id:"jsonpath-syntax",children:"JSONPath Syntax"}),"\n",(0,s.jsx)(n.p,{children:"Use JSONPath to select fields:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:'fields:\n  # Direct field\n  - path: "$.email"\n\n  # Nested field\n  - path: "$.customer.ssn"\n\n  # Array element\n  - path: "$.items[*].price"\n\n  # Wildcard\n  - path: "$.*.secret"\n\n  # Deep wildcard\n  - path: "$..password"\n'})}),"\n",(0,s.jsx)(n.h3,{id:"examples",children:"Examples"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:'# E-commerce order\nfields:\n  - path: "$.customer.email"\n  - path: "$.customer.phone"\n  - path: "$.payment.card_number"\n  - path: "$.payment.cvv"\n  - path: "$.shipping.address"\n\n# Healthcare record\nfields:\n  - path: "$.patient.ssn"\n  - path: "$.patient.date_of_birth"\n  - path: "$.diagnosis[*].details"\n  - path: "$..notes"\n\n# Financial transaction\nfields:\n  - path: "$.account_number"\n  - path: "$.routing_number"\n  - path: "$.beneficiary.tax_id"\n'})}),"\n",(0,s.jsx)(n.h2,{id:"encryption-algorithms",children:"Encryption Algorithms"}),"\n",(0,s.jsx)(n.h3,{id:"supported-algorithms",children:"Supported Algorithms"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Algorithm"}),(0,s.jsx)(n.th,{children:"Key Size"}),(0,s.jsx)(n.th,{children:"Use Case"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"AES-256-GCM"}),(0,s.jsx)(n.td,{children:"256 bit"}),(0,s.jsx)(n.td,{children:"Default, recommended"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"AES-128-GCM"}),(0,s.jsx)(n.td,{children:"128 bit"}),(0,s.jsx)(n.td,{children:"Faster, still secure"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"ChaCha20-Poly1305"}),(0,s.jsx)(n.td,{children:"256 bit"}),(0,s.jsx)(n.td,{children:"Alternative to AES"})]})]})]}),"\n",(0,s.jsx)(n.h3,{id:"algorithm-configuration",children:"Algorithm Configuration"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:'enterprise:\n  encryption:\n    enabled: true\n    default_algorithm: AES-256-GCM\n\n    fields:\n      - path: "$.ssn"\n        algorithm: AES-256-GCM\n\n      - path: "$.large_blob"\n        algorithm: ChaCha20-Poly1305  # Better for large data\n'})}),"\n",(0,s.jsx)(n.h2,{id:"topic-specific-encryption",children:"Topic-Specific Encryption"}),"\n",(0,s.jsx)(n.p,{children:"Different encryption for different topics:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:'enterprise:\n  encryption:\n    enabled: true\n\n    topics:\n      - pattern: "orders*"\n        fields:\n          - path: "$.customer.email"\n          - path: "$.payment.card_number"\n\n      - pattern: "healthcare*"\n        fields:\n          - path: "$.patient.ssn"\n          - path: "$..diagnosis"\n\n      - pattern: "financial*"\n        fields:\n          - path: "$.account_number"\n          - path: "$.routing_number"\n'})}),"\n",(0,s.jsx)(n.h2,{id:"restore-behavior",children:"Restore Behavior"}),"\n",(0,s.jsx)(n.h3,{id:"decryption-on-restore",children:"Decryption on Restore"}),"\n",(0,s.jsx)(n.p,{children:"By default, encrypted fields are decrypted during restore:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:'mode: restore\n\nenterprise:\n  encryption:\n    decrypt_on_restore: true  # Default\n    key_provider: aws-kms\n    kms_key_id: "arn:aws:kms:..."\n'})}),"\n",(0,s.jsx)(n.h3,{id:"keep-encrypted",children:"Keep Encrypted"}),"\n",(0,s.jsx)(n.p,{children:"To keep fields encrypted after restore:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"enterprise:\n  encryption:\n    decrypt_on_restore: false\n"})}),"\n",(0,s.jsx)(n.h3,{id:"re-encrypt-with-different-key",children:"Re-encrypt with Different Key"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:'enterprise:\n  encryption:\n    decrypt_on_restore: true\n\n    # Re-encrypt with new key for target environment\n    re_encrypt:\n      enabled: true\n      key_provider: aws-kms\n      kms_key_id: "arn:aws:kms:us-east-1:..."  # Different key\n'})}),"\n",(0,s.jsx)(n.h2,{id:"key-rotation",children:"Key Rotation"}),"\n",(0,s.jsx)(n.h3,{id:"automatic-key-rotation",children:"Automatic Key Rotation"}),"\n",(0,s.jsx)(n.p,{children:"With KMS providers, key rotation is handled automatically:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"# AWS KMS - enable automatic rotation\naws kms enable-key-rotation --key-id 12345678-...\n\n# Backups use current key version\n# Restore can use any key version (KMS handles it)\n"})}),"\n",(0,s.jsx)(n.h3,{id:"manual-key-rotation",children:"Manual Key Rotation"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"enterprise:\n  encryption:\n    key_provider: env\n    key_env_var: ENCRYPTION_KEY\n\n    # For manual rotation, keep old keys accessible\n    old_keys:\n      - env_var: ENCRYPTION_KEY_V1\n      - env_var: ENCRYPTION_KEY_V2\n"})}),"\n",(0,s.jsx)(n.p,{children:"Restore will try keys in order until one works."}),"\n",(0,s.jsx)(n.h2,{id:"data-masking",children:"Data Masking"}),"\n",(0,s.jsx)(n.p,{children:"For non-production environments, mask instead of encrypt:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:'enterprise:\n  masking:\n    enabled: true\n\n    rules:\n      - field: "$.customer.email"\n        type: email\n        # john.doe@company.com \u2192 j***@c***.com\n\n      - field: "$.customer.phone"\n        type: phone\n        # +1-555-123-4567 \u2192 +1-555-***-****\n\n      - field: "$.customer.ssn"\n        type: ssn\n        # 123-45-6789 \u2192 ***-**-6789\n\n      - field: "$.customer.name"\n        type: name\n        # John Doe \u2192 J*** D***\n\n      - field: "$.payment.card_number"\n        type: credit_card\n        # 4111111111111111 \u2192 ************1111\n\n      - field: "$.address"\n        type: redact\n        # Any value \u2192 [REDACTED]\n'})}),"\n",(0,s.jsx)(n.h3,{id:"masking-types",children:"Masking Types"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Type"}),(0,s.jsx)(n.th,{children:"Description"}),(0,s.jsx)(n.th,{children:"Example"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"email"})}),(0,s.jsx)(n.td,{children:"Partial email masking"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"j***@e***.com"})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"phone"})}),(0,s.jsx)(n.td,{children:"Last 4 digits visible"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"***-***-1234"})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"ssn"})}),(0,s.jsx)(n.td,{children:"Last 4 digits visible"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"***-**-6789"})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"name"})}),(0,s.jsx)(n.td,{children:"First letter visible"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"J*** D***"})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"credit_card"})}),(0,s.jsx)(n.td,{children:"Last 4 digits visible"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"************1111"})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"redact"})}),(0,s.jsx)(n.td,{children:"Complete replacement"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"[REDACTED]"})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"hash"})}),(0,s.jsx)(n.td,{children:"Consistent hash"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"a1b2c3d4..."})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"random"})}),(0,s.jsx)(n.td,{children:"Random replacement"}),(0,s.jsx)(n.td,{children:"Random value"})]})]})]}),"\n",(0,s.jsx)(n.h3,{id:"custom-masking",children:"Custom Masking"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:'enterprise:\n  masking:\n    rules:\n      - field: "$.custom_id"\n        type: custom\n        pattern: "XXX-{last:4}"  # Show last 4\n\n      - field: "$.internal_code"\n        type: custom\n        pattern: "{first:2}***{last:2}"  # Show first 2 and last 2\n'})}),"\n",(0,s.jsx)(n.h2,{id:"kubernetes-configuration",children:"Kubernetes Configuration"}),"\n",(0,s.jsx)(n.h3,{id:"secrets-for-encryption-keys",children:"Secrets for Encryption Keys"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:'apiVersion: v1\nkind: Secret\nmetadata:\n  name: encryption-key\n  namespace: kafka-backup\ntype: Opaque\nstringData:\n  key: "your-32-byte-encryption-key-here"\n'})}),"\n",(0,s.jsx)(n.h3,{id:"operator-configuration",children:"Operator Configuration"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:'apiVersion: kafka.oso.sh/v1alpha1\nkind: KafkaBackup\nmetadata:\n  name: encrypted-backup\nspec:\n  enterprise:\n    licenseSecret:\n      name: kafka-backup-license\n      key: license.key\n\n    encryption:\n      enabled: true\n      keySecret:\n        name: encryption-key\n        key: key\n      fields:\n        - "$.customer.ssn"\n        - "$.customer.email"\n'})}),"\n",(0,s.jsx)(n.h2,{id:"verification",children:"Verification"}),"\n",(0,s.jsx)(n.h3,{id:"verify-encryption",children:"Verify Encryption"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"# Check backup metadata\nkafka-backup describe \\\n  --path s3://bucket/backups \\\n  --backup-id my-backup \\\n  --format json | jq '.encryption'\n"})}),"\n",(0,s.jsx)(n.p,{children:"Output:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\n  "enabled": true,\n  "algorithm": "AES-256-GCM",\n  "encrypted_fields": [\n    "$.customer.ssn",\n    "$.customer.email"\n  ],\n  "key_provider": "aws-kms",\n  "key_id": "arn:aws:kms:..."\n}\n'})}),"\n",(0,s.jsx)(n.h3,{id:"sample-encrypted-data",children:"Sample Encrypted Data"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"# View sample records from backup (shows encrypted fields)\nkafka-backup sample \\\n  --path s3://bucket/backups \\\n  --backup-id my-backup \\\n  --topic orders \\\n  --count 5\n"})}),"\n",(0,s.jsx)(n.h2,{id:"performance-impact",children:"Performance Impact"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Operation"}),(0,s.jsx)(n.th,{children:"Without Encryption"}),(0,s.jsx)(n.th,{children:"With Encryption"}),(0,s.jsx)(n.th,{children:"Overhead"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Backup"}),(0,s.jsx)(n.td,{children:"100 MB/s"}),(0,s.jsx)(n.td,{children:"90 MB/s"}),(0,s.jsx)(n.td,{children:"~10%"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Restore (decrypt)"}),(0,s.jsx)(n.td,{children:"150 MB/s"}),(0,s.jsx)(n.td,{children:"120 MB/s"}),(0,s.jsx)(n.td,{children:"~20%"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Restore (no decrypt)"}),(0,s.jsx)(n.td,{children:"150 MB/s"}),(0,s.jsx)(n.td,{children:"148 MB/s"}),(0,s.jsx)(n.td,{children:"~1%"})]})]})]}),"\n",(0,s.jsx)(n.p,{children:"For best performance:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Use hardware AES acceleration (available on most modern CPUs)"}),"\n",(0,s.jsx)(n.li,{children:"Limit encryption to truly sensitive fields"}),"\n",(0,s.jsx)(n.li,{children:"Use KMS with local caching"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"best-practices",children:"Best Practices"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Encrypt only what's needed"})," - Don't encrypt everything"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Use KMS"})," - Better key management than static keys"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Document encrypted fields"})," - Know what's protected"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Test restore"})," - Verify decryption works"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Key backup"})," - Ensure keys are recoverable"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Audit access"})," - Log encryption/decryption operations"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"troubleshooting",children:"Troubleshooting"}),"\n",(0,s.jsx)(n.h3,{id:"decryption-failed",children:"Decryption Failed"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"Error: Failed to decrypt field $.customer.ssn\n"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Causes:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Wrong key"}),"\n",(0,s.jsx)(n.li,{children:"Key rotated without old key available"}),"\n",(0,s.jsx)(n.li,{children:"Corrupted data"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Solution:"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"# Add old keys for rotation\nenterprise:\n  encryption:\n    key_provider: env\n    key_env_var: CURRENT_KEY\n    old_keys:\n      - env_var: OLD_KEY_V1\n      - env_var: OLD_KEY_V2\n"})}),"\n",(0,s.jsx)(n.h3,{id:"kms-access-denied",children:"KMS Access Denied"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"Error: Access denied to KMS key\n"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Solution:"})," Check IAM permissions:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\n  "Version": "2012-10-17",\n  "Statement": [\n    {\n      "Effect": "Allow",\n      "Action": [\n        "kms:Encrypt",\n        "kms:Decrypt",\n        "kms:GenerateDataKey"\n      ],\n      "Resource": "arn:aws:kms:region:account:key/key-id"\n    }\n  ]\n}\n'})}),"\n",(0,s.jsx)(n.h2,{id:"next-steps",children:"Next Steps"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"./rbac",children:"RBAC Configuration"})," - Control access to encryption keys"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"./audit-logging",children:"Audit Logging"})," - Log encryption operations"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"../use-cases/compliance-audit",children:"Compliance Guide"})," - Compliance requirements"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(o,{...e})}):o(e)}},8453:(e,n,r)=>{r.d(n,{R:()=>a,x:()=>l});var i=r(6540);const s={},t=i.createContext(s);function a(e){const n=i.useContext(t);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:a(e.components),i.createElement(t.Provider,{value:n},e.children)}}}]);