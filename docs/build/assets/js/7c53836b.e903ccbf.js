"use strict";(globalThis.webpackChunkkafka_backup_docs=globalThis.webpackChunkkafka_backup_docs||[]).push([[9718],{6549:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>l,contentTitle:()=>c,default:()=>h,frontMatter:()=>i,metadata:()=>s,toc:()=>o});const s=JSON.parse('{"id":"operator/index","title":"Operator Overview","description":"Kubernetes Operator for OSO Kafka Backup","source":"@site/docs/operator/index.md","sourceDirName":"operator","slug":"/operator/","permalink":"/operator/","draft":false,"unlisted":false,"editUrl":"https://github.com/osodevops/kafka-backup-docs/tree/main/docs/docs/operator/index.md","tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"title":"Operator Overview","description":"Kubernetes Operator for OSO Kafka Backup","sidebar_position":1},"sidebar":"docsSidebar","previous":{"title":"Metrics Reference","permalink":"/reference/metrics"},"next":{"title":"Installation","permalink":"/operator/installation"}}');var a=r(4848),t=r(8453);const i={title:"Operator Overview",description:"Kubernetes Operator for OSO Kafka Backup",sidebar_position:1},c="Kubernetes Operator",l={},o=[{value:"Overview",id:"overview",level:2},{value:"Custom Resource Definitions",id:"custom-resource-definitions",level:2},{value:"Architecture",id:"architecture",level:2},{value:"Features",id:"features",level:2},{value:"Scheduled Backups",id:"scheduled-backups",level:3},{value:"Point-in-Time Recovery",id:"point-in-time-recovery",level:3},{value:"Offset Management",id:"offset-management",level:3},{value:"GitOps Integration",id:"gitops-integration",level:3},{value:"Quick Start",id:"quick-start",level:2},{value:"1. Install the Operator",id:"1-install-the-operator",level:3},{value:"2. Create a Backup",id:"2-create-a-backup",level:3},{value:"3. Monitor Progress",id:"3-monitor-progress",level:3},{value:"API Reference",id:"api-reference",level:2},{value:"API Group and Version",id:"api-group-and-version",level:3},{value:"Resource Types",id:"resource-types",level:3},{value:"Comparison with CLI",id:"comparison-with-cli",level:2},{value:"Prerequisites",id:"prerequisites",level:2},{value:"Next Steps",id:"next-steps",level:2}];function d(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.header,{children:(0,a.jsx)(n.h1,{id:"kubernetes-operator",children:"Kubernetes Operator"})}),"\n",(0,a.jsx)(n.p,{children:"The OSO Kafka Backup Operator provides Kubernetes-native management of Kafka backup and restore operations."}),"\n",(0,a.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,a.jsx)(n.p,{children:"The operator extends Kubernetes with Custom Resource Definitions (CRDs) that allow you to:"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"Schedule automated backups"}),"\n",(0,a.jsx)(n.li,{children:"Perform point-in-time restores"}),"\n",(0,a.jsx)(n.li,{children:"Manage consumer group offsets"}),"\n",(0,a.jsx)(n.li,{children:"Snapshot and rollback consumer positions"}),"\n"]}),"\n",(0,a.jsx)(n.h2,{id:"custom-resource-definitions",children:"Custom Resource Definitions"}),"\n",(0,a.jsxs)(n.table,{children:[(0,a.jsx)(n.thead,{children:(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.th,{children:"CRD"}),(0,a.jsx)(n.th,{children:"Short Name"}),(0,a.jsx)(n.th,{children:"Description"})]})}),(0,a.jsxs)(n.tbody,{children:[(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:(0,a.jsx)(n.code,{children:"KafkaBackup"})}),(0,a.jsx)(n.td,{children:(0,a.jsx)(n.code,{children:"kb"})}),(0,a.jsx)(n.td,{children:"Backup Kafka topics to object storage"})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:(0,a.jsx)(n.code,{children:"KafkaRestore"})}),(0,a.jsx)(n.td,{children:(0,a.jsx)(n.code,{children:"kr"})}),(0,a.jsx)(n.td,{children:"Restore data from backups"})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:(0,a.jsx)(n.code,{children:"KafkaOffsetReset"})}),(0,a.jsx)(n.td,{children:(0,a.jsx)(n.code,{children:"kor"})}),(0,a.jsx)(n.td,{children:"Reset consumer group offsets"})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:(0,a.jsx)(n.code,{children:"KafkaOffsetRollback"})}),(0,a.jsx)(n.td,{children:(0,a.jsx)(n.code,{children:"korb"})}),(0,a.jsx)(n.td,{children:"Snapshot and rollback consumer offsets"})]})]})]}),"\n",(0,a.jsx)(n.h2,{id:"architecture",children:"Architecture"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                         Kubernetes Cluster                                   \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                              \u2502\n\u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u2502\n\u2502   \u2502                   Kafka Backup Operator                              \u2502   \u2502\n\u2502   \u2502                                                                      \u2502   \u2502\n\u2502   \u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510              \u2502   \u2502\n\u2502   \u2502  \u2502   Backup     \u2502  \u2502   Restore    \u2502  \u2502   Offset     \u2502              \u2502   \u2502\n\u2502   \u2502  \u2502  Controller  \u2502  \u2502  Controller  \u2502  \u2502  Controller  \u2502              \u2502   \u2502\n\u2502   \u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518              \u2502   \u2502\n\u2502   \u2502         \u2502                 \u2502                 \u2502                       \u2502   \u2502\n\u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2502\n\u2502             \u2502                 \u2502                 \u2502                            \u2502\n\u2502             \u25bc                 \u25bc                 \u25bc                            \u2502\n\u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u2502\n\u2502   \u2502                      Custom Resources                                \u2502   \u2502\n\u2502   \u2502                                                                      \u2502   \u2502\n\u2502   \u2502   KafkaBackup      KafkaRestore    KafkaOffsetReset                 \u2502   \u2502\n\u2502   \u2502   KafkaOffsetRollback                                                \u2502   \u2502\n\u2502   \u2502                                                                      \u2502   \u2502\n\u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2502\n\u2502                                                                              \u2502\n\u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510            \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510                      \u2502\n\u2502   \u2502  Kafka Cluster   \u2502            \u2502  Object Storage  \u2502                      \u2502\n\u2502   \u2502                  \u2502\u25c0\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25b6\u2502  (S3/Azure/GCS)  \u2502                      \u2502\n\u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518            \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518                      \u2502\n\u2502                                                                              \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,a.jsx)(n.h2,{id:"features",children:"Features"}),"\n",(0,a.jsx)(n.h3,{id:"scheduled-backups",children:"Scheduled Backups"}),"\n",(0,a.jsx)(n.p,{children:"Create automated backup schedules using cron expressions:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-yaml",children:'apiVersion: kafka.oso.sh/v1alpha1\nkind: KafkaBackup\nmetadata:\n  name: hourly-backup\nspec:\n  schedule: "0 * * * *"  # Every hour\n  kafkaCluster:\n    bootstrapServers:\n      - kafka:9092\n  topics:\n    - orders\n    - payments\n  storage:\n    storageType: s3\n    s3:\n      bucket: kafka-backups\n'})}),"\n",(0,a.jsx)(n.h3,{id:"point-in-time-recovery",children:"Point-in-Time Recovery"}),"\n",(0,a.jsx)(n.p,{children:"Restore data to any specific moment:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-yaml",children:'apiVersion: kafka.oso.sh/v1alpha1\nkind: KafkaRestore\nmetadata:\n  name: pitr-restore\nspec:\n  backupId: "backup-20241201-120000"\n  pitr:\n    enabled: true\n    timestamp: "2024-12-01T12:00:00Z"\n'})}),"\n",(0,a.jsx)(n.h3,{id:"offset-management",children:"Offset Management"}),"\n",(0,a.jsx)(n.p,{children:"Manage consumer group offsets across clusters:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-yaml",children:"apiVersion: kafka.oso.sh/v1alpha1\nkind: KafkaOffsetReset\nmetadata:\n  name: reset-after-restore\nspec:\n  strategy: headerBased\n  consumerGroups:\n    - order-processor\n"})}),"\n",(0,a.jsx)(n.h3,{id:"gitops-integration",children:"GitOps Integration"}),"\n",(0,a.jsx)(n.p,{children:"All resources are declarative and version-controllable:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-yaml",children:"# backup.yaml - Store in Git\napiVersion: kafka.oso.sh/v1alpha1\nkind: KafkaBackup\nmetadata:\n  name: production-backup\nspec:\n  # ...\n"})}),"\n",(0,a.jsx)(n.h2,{id:"quick-start",children:"Quick Start"}),"\n",(0,a.jsx)(n.h3,{id:"1-install-the-operator",children:"1. Install the Operator"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"# Add Helm repository\nhelm repo add oso https://charts.oso.sh\nhelm repo update\n\n# Install operator\nhelm install kafka-backup-operator oso/kafka-backup-operator \\\n  --namespace kafka-backup \\\n  --create-namespace\n"})}),"\n",(0,a.jsx)(n.h3,{id:"2-create-a-backup",children:"2. Create a Backup"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-yaml",children:"apiVersion: kafka.oso.sh/v1alpha1\nkind: KafkaBackup\nmetadata:\n  name: my-first-backup\n  namespace: kafka-backup\nspec:\n  kafkaCluster:\n    bootstrapServers:\n      - kafka.default.svc:9092\n  topics:\n    - my-topic\n  storage:\n    storageType: s3\n    s3:\n      bucket: my-kafka-backups\n      region: us-west-2\n"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"kubectl apply -f backup.yaml\n"})}),"\n",(0,a.jsx)(n.h3,{id:"3-monitor-progress",children:"3. Monitor Progress"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"kubectl get kafkabackup my-first-backup -o yaml\n\n# Or watch status\nkubectl get kafkabackup -w\n"})}),"\n",(0,a.jsx)(n.h2,{id:"api-reference",children:"API Reference"}),"\n",(0,a.jsx)(n.h3,{id:"api-group-and-version",children:"API Group and Version"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"API Group"}),": ",(0,a.jsx)(n.code,{children:"kafka.oso.sh"})]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"API Version"}),": ",(0,a.jsx)(n.code,{children:"v1alpha1"})]}),"\n"]}),"\n",(0,a.jsx)(n.h3,{id:"resource-types",children:"Resource Types"}),"\n",(0,a.jsxs)(n.table,{children:[(0,a.jsx)(n.thead,{children:(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.th,{children:"Kind"}),(0,a.jsx)(n.th,{children:"Description"})]})}),(0,a.jsxs)(n.tbody,{children:[(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:(0,a.jsx)(n.code,{children:"KafkaBackup"})}),(0,a.jsx)(n.td,{children:"Defines backup configuration and schedule"})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:(0,a.jsx)(n.code,{children:"KafkaRestore"})}),(0,a.jsx)(n.td,{children:"Defines restore operation"})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:(0,a.jsx)(n.code,{children:"KafkaOffsetReset"})}),(0,a.jsx)(n.td,{children:"Defines offset reset operation"})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:(0,a.jsx)(n.code,{children:"KafkaOffsetRollback"})}),(0,a.jsx)(n.td,{children:"Defines offset snapshot/rollback"})]})]})]}),"\n",(0,a.jsx)(n.h2,{id:"comparison-with-cli",children:"Comparison with CLI"}),"\n",(0,a.jsxs)(n.table,{children:[(0,a.jsx)(n.thead,{children:(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.th,{children:"Feature"}),(0,a.jsx)(n.th,{children:"CLI"}),(0,a.jsx)(n.th,{children:"Operator"})]})}),(0,a.jsxs)(n.tbody,{children:[(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:"Scheduled backups"}),(0,a.jsx)(n.td,{children:"External scheduler (cron)"}),(0,a.jsx)(n.td,{children:"Built-in (CronJob)"})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:"Declarative config"}),(0,a.jsx)(n.td,{children:"YAML files"}),(0,a.jsx)(n.td,{children:"Kubernetes CRDs"})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:"GitOps"}),(0,a.jsx)(n.td,{children:"Manual"}),(0,a.jsx)(n.td,{children:"Native"})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:"Monitoring"}),(0,a.jsx)(n.td,{children:"Prometheus endpoint"}),(0,a.jsx)(n.td,{children:"ServiceMonitor"})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:"HA deployment"}),(0,a.jsx)(n.td,{children:"Manual"}),(0,a.jsx)(n.td,{children:"Built-in"})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:"Secret management"}),(0,a.jsx)(n.td,{children:"Environment variables"}),(0,a.jsx)(n.td,{children:"Kubernetes Secrets"})]})]})]}),"\n",(0,a.jsx)(n.h2,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"Kubernetes 1.20+"}),"\n",(0,a.jsx)(n.li,{children:"Helm 3.0+ (for installation)"}),"\n",(0,a.jsx)(n.li,{children:"Access to Kafka cluster"}),"\n",(0,a.jsx)(n.li,{children:"Access to object storage (S3, Azure, GCS)"}),"\n"]}),"\n",(0,a.jsx)(n.h2,{id:"next-steps",children:"Next Steps"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.a,{href:"./installation",children:"Installation"})," - Install the operator"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.a,{href:"./configuration",children:"Configuration"})," - Configure Helm values"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.a,{href:"./crds/kafkabackup",children:"KafkaBackup CRD"})," - Backup resource reference"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.a,{href:"./guides/scheduled-backups",children:"Scheduled Backups Guide"})," - Set up automated backups"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(d,{...e})}):d(e)}},8453:(e,n,r)=>{r.d(n,{R:()=>i,x:()=>c});var s=r(6540);const a={},t=s.createContext(a);function i(e){const n=s.useContext(t);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:i(e.components),s.createElement(t.Provider,{value:n},e.children)}}}]);