"use strict";(globalThis.webpackChunkkafka_backup_docs=globalThis.webpackChunkkafka_backup_docs||[]).push([[1410],{8453:(e,n,i)=>{i.d(n,{R:()=>r,x:()=>l});var t=i(6540);const s={},a=t.createContext(s);function r(e){const n=t.useContext(a);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:r(e.components),t.createElement(a.Provider,{value:n},e.children)}},8517:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>c,contentTitle:()=>l,default:()=>u,frontMatter:()=>r,metadata:()=>t,toc:()=>d});const t=JSON.parse('{"id":"enterprise/audit-logging","title":"Audit Logging","description":"Comprehensive audit trails for OSO Kafka Backup Enterprise","source":"@site/docs/enterprise/audit-logging.md","sourceDirName":"enterprise","slug":"/enterprise/audit-logging","permalink":"/enterprise/audit-logging","draft":false,"unlisted":false,"editUrl":"https://github.com/osodevops/kafka-backup-docs/tree/main/docs/docs/enterprise/audit-logging.md","tags":[],"version":"current","sidebarPosition":4,"frontMatter":{"title":"Audit Logging","description":"Comprehensive audit trails for OSO Kafka Backup Enterprise","sidebar_position":4},"sidebar":"docsSidebar","previous":{"title":"RBAC","permalink":"/enterprise/rbac"},"next":{"title":"Schema Registry","permalink":"/enterprise/schema-registry"}}');var s=i(4848),a=i(8453);const r={title:"Audit Logging",description:"Comprehensive audit trails for OSO Kafka Backup Enterprise",sidebar_position:4},l="Audit Logging",c={},d=[{value:"Overview",id:"overview",level:2},{value:"Configuration",id:"configuration",level:2},{value:"Basic Audit Configuration",id:"basic-audit-configuration",level:3},{value:"Audit Destinations",id:"audit-destinations",level:3},{value:"File",id:"file",level:4},{value:"S3",id:"s3",level:4},{value:"CloudWatch Logs",id:"cloudwatch-logs",level:4},{value:"Kafka Topic",id:"kafka-topic",level:4},{value:"Syslog",id:"syslog",level:4},{value:"Webhook",id:"webhook",level:4},{value:"Multiple Destinations",id:"multiple-destinations",level:3},{value:"Audit Events",id:"audit-events",level:2},{value:"Event Categories",id:"event-categories",level:3},{value:"Event Configuration",id:"event-configuration",level:3},{value:"Audit Log Format",id:"audit-log-format",level:2},{value:"Standard Fields",id:"standard-fields",level:3},{value:"Event-Specific Fields",id:"event-specific-fields",level:3},{value:"Backup Events",id:"backup-events",level:4},{value:"Restore Events",id:"restore-events",level:4},{value:"Access Denied Events",id:"access-denied-events",level:4},{value:"Configuration Change Events",id:"configuration-change-events",level:4},{value:"Compliance Features",id:"compliance-features",level:2},{value:"Immutable Logging",id:"immutable-logging",level:3},{value:"Log Format",id:"log-format",level:3},{value:"Retention Policies",id:"retention-policies",level:3},{value:"Searching and Analysis",id:"searching-and-analysis",level:2},{value:"Structured Logging",id:"structured-logging",level:3},{value:"CloudWatch Insights",id:"cloudwatch-insights",level:3},{value:"Elasticsearch/OpenSearch",id:"elasticsearchopensearch",level:3},{value:"Alerting",id:"alerting",level:2},{value:"Alert Configuration",id:"alert-configuration",level:3},{value:"Alert Integrations",id:"alert-integrations",level:3},{value:"Slack",id:"slack",level:4},{value:"PagerDuty",id:"pagerduty",level:4},{value:"Email",id:"email",level:4},{value:"Kubernetes Configuration",id:"kubernetes-configuration",level:2},{value:"ConfigMap for Audit Config",id:"configmap-for-audit-config",level:3},{value:"Volume Mount for File Logging",id:"volume-mount-for-file-logging",level:3},{value:"Best Practices",id:"best-practices",level:2},{value:"Sample Compliance Report",id:"sample-compliance-report",level:2},{value:"Next Steps",id:"next-steps",level:2}];function o(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,a.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"audit-logging",children:"Audit Logging"})}),"\n",(0,s.jsx)(n.p,{children:"OSO Kafka Backup Enterprise provides comprehensive audit logging for compliance and security monitoring."}),"\n",(0,s.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,s.jsx)(n.p,{children:"Audit logging captures:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"All backup operations"}),"\n",(0,s.jsx)(n.li,{children:"All restore operations"}),"\n",(0,s.jsx)(n.li,{children:"Configuration changes"}),"\n",(0,s.jsx)(n.li,{children:"Access attempts (successful and denied)"}),"\n",(0,s.jsx)(n.li,{children:"Administrative actions"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"configuration",children:"Configuration"}),"\n",(0,s.jsx)(n.h3,{id:"basic-audit-configuration",children:"Basic Audit Configuration"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"enterprise:\n  audit:\n    enabled: true\n\n    # Where to send audit logs\n    destination:\n      type: file\n      path: /var/log/kafka-backup/audit.log\n\n    # What to log\n    events:\n      - backup.started\n      - backup.completed\n      - backup.failed\n      - restore.started\n      - restore.completed\n      - restore.failed\n      - access.denied\n      - config.changed\n"})}),"\n",(0,s.jsx)(n.h3,{id:"audit-destinations",children:"Audit Destinations"}),"\n",(0,s.jsx)(n.h4,{id:"file",children:"File"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"enterprise:\n  audit:\n    destination:\n      type: file\n      path: /var/log/kafka-backup/audit.log\n      rotation:\n        max_size_mb: 100\n        max_files: 10\n        compress: true\n"})}),"\n",(0,s.jsx)(n.h4,{id:"s3",children:"S3"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"enterprise:\n  audit:\n    destination:\n      type: s3\n      bucket: audit-logs\n      prefix: kafka-backup/\n      region: us-west-2\n      # Logs are batched and uploaded periodically\n      batch_interval_secs: 60\n"})}),"\n",(0,s.jsx)(n.h4,{id:"cloudwatch-logs",children:"CloudWatch Logs"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"enterprise:\n  audit:\n    destination:\n      type: cloudwatch\n      log_group: /kafka-backup/audit\n      log_stream: ${HOSTNAME}\n      region: us-west-2\n"})}),"\n",(0,s.jsx)(n.h4,{id:"kafka-topic",children:"Kafka Topic"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"enterprise:\n  audit:\n    destination:\n      type: kafka\n      bootstrap_servers:\n        - kafka:9092\n      topic: audit-events\n      security:\n        security_protocol: SASL_SSL\n        sasl_mechanism: SCRAM-SHA-256\n        sasl_username: audit-producer\n        sasl_password: ${AUDIT_KAFKA_PASSWORD}\n"})}),"\n",(0,s.jsx)(n.h4,{id:"syslog",children:"Syslog"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"enterprise:\n  audit:\n    destination:\n      type: syslog\n      server: syslog.company.com:514\n      protocol: tcp  # or udp\n      facility: local0\n"})}),"\n",(0,s.jsx)(n.h4,{id:"webhook",children:"Webhook"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"enterprise:\n  audit:\n    destination:\n      type: webhook\n      url: https://siem.company.com/ingest\n      headers:\n        Authorization: Bearer ${WEBHOOK_TOKEN}\n      batch_size: 100\n      retry_attempts: 3\n"})}),"\n",(0,s.jsx)(n.h3,{id:"multiple-destinations",children:"Multiple Destinations"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"enterprise:\n  audit:\n    destinations:\n      - type: file\n        path: /var/log/kafka-backup/audit.log\n\n      - type: s3\n        bucket: audit-archive\n        prefix: kafka-backup/\n\n      - type: kafka\n        bootstrap_servers:\n          - kafka:9092\n        topic: audit-events\n"})}),"\n",(0,s.jsx)(n.h2,{id:"audit-events",children:"Audit Events"}),"\n",(0,s.jsx)(n.h3,{id:"event-categories",children:"Event Categories"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Category"}),(0,s.jsx)(n.th,{children:"Events"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Backup"})}),(0,s.jsx)(n.td,{children:"started, completed, failed, cancelled"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Restore"})}),(0,s.jsx)(n.td,{children:"started, completed, failed, cancelled"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Validate"})}),(0,s.jsx)(n.td,{children:"started, completed, failed"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Access"})}),(0,s.jsx)(n.td,{children:"granted, denied"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Config"})}),(0,s.jsx)(n.td,{children:"changed, viewed"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Auth"})}),(0,s.jsx)(n.td,{children:"login, logout, token_refresh"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Admin"})}),(0,s.jsx)(n.td,{children:"license_applied, feature_enabled"})]})]})]}),"\n",(0,s.jsx)(n.h3,{id:"event-configuration",children:"Event Configuration"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"enterprise:\n  audit:\n    events:\n      # Backup events\n      - backup.started\n      - backup.completed\n      - backup.failed\n      - backup.checkpoint  # Include progress checkpoints\n\n      # Restore events\n      - restore.started\n      - restore.completed\n      - restore.failed\n\n      # Security events (always recommended)\n      - access.denied\n      - auth.login\n      - auth.logout\n      - auth.failed\n\n      # Configuration events\n      - config.changed\n\n    # Exclude specific events\n    exclude_events:\n      - backup.checkpoint  # If too verbose\n"})}),"\n",(0,s.jsx)(n.h2,{id:"audit-log-format",children:"Audit Log Format"}),"\n",(0,s.jsx)(n.h3,{id:"standard-fields",children:"Standard Fields"}),"\n",(0,s.jsx)(n.p,{children:"Every audit event includes:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\n  "timestamp": "2024-12-01T10:15:30.123Z",\n  "event_type": "backup.completed",\n  "event_id": "evt_abc123def456",\n  "version": "1.0",\n\n  "actor": {\n    "type": "user",\n    "id": "alice@company.com",\n    "roles": ["backup-operator"],\n    "ip_address": "10.0.0.50",\n    "user_agent": "kafka-backup-cli/1.0.0"\n  },\n\n  "resource": {\n    "type": "backup",\n    "id": "production-backup-20241201",\n    "path": "s3://kafka-backups/production/"\n  },\n\n  "action": {\n    "operation": "backup",\n    "result": "success",\n    "duration_ms": 45000\n  },\n\n  "context": {\n    "cluster_id": "prod-us-west-2",\n    "environment": "production",\n    "correlation_id": "req_xyz789"\n  }\n}\n'})}),"\n",(0,s.jsx)(n.h3,{id:"event-specific-fields",children:"Event-Specific Fields"}),"\n",(0,s.jsx)(n.h4,{id:"backup-events",children:"Backup Events"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\n  "event_type": "backup.completed",\n  "details": {\n    "backup_id": "production-backup-20241201",\n    "topics": ["orders", "payments", "users"],\n    "records_backed_up": 1500000,\n    "bytes_backed_up": 524288000,\n    "compressed_bytes": 104857600,\n    "compression_ratio": 5.0,\n    "duration_secs": 120,\n    "checkpoints": 4\n  }\n}\n'})}),"\n",(0,s.jsx)(n.h4,{id:"restore-events",children:"Restore Events"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\n  "event_type": "restore.completed",\n  "details": {\n    "backup_id": "production-backup-20241201",\n    "target_cluster": "dr-us-east-1",\n    "topics_restored": ["orders", "payments"],\n    "records_restored": 1000000,\n    "pitr_enabled": true,\n    "time_window_start": "2024-12-01T00:00:00Z",\n    "time_window_end": "2024-12-01T12:00:00Z",\n    "topic_mapping": {\n      "orders": "restored-orders"\n    }\n  }\n}\n'})}),"\n",(0,s.jsx)(n.h4,{id:"access-denied-events",children:"Access Denied Events"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\n  "event_type": "access.denied",\n  "details": {\n    "operation": "restore",\n    "resource": "topic:production-orders",\n    "required_permission": "restore:topic:production-orders",\n    "user_permissions": ["backup:*", "list:*"],\n    "reason": "insufficient_permissions"\n  }\n}\n'})}),"\n",(0,s.jsx)(n.h4,{id:"configuration-change-events",children:"Configuration Change Events"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\n  "event_type": "config.changed",\n  "details": {\n    "config_type": "backup",\n    "changes": [\n      {\n        "field": "compression_level",\n        "old_value": "3",\n        "new_value": "6"\n      },\n      {\n        "field": "topics.include",\n        "old_value": ["orders"],\n        "new_value": ["orders", "payments"]\n      }\n    ]\n  }\n}\n'})}),"\n",(0,s.jsx)(n.h2,{id:"compliance-features",children:"Compliance Features"}),"\n",(0,s.jsx)(n.h3,{id:"immutable-logging",children:"Immutable Logging"}),"\n",(0,s.jsx)(n.p,{children:"Ensure logs cannot be tampered with:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"enterprise:\n  audit:\n    destination:\n      type: s3\n      bucket: compliance-audit-logs\n      object_lock: true  # Use S3 Object Lock\n\n    integrity:\n      signing:\n        enabled: true\n        algorithm: HMAC-SHA256\n        key_env_var: AUDIT_SIGNING_KEY\n\n      chain:\n        enabled: true  # Chain signatures for tamper detection\n"})}),"\n",(0,s.jsx)(n.h3,{id:"log-format",children:"Log Format"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\n  "event": { /* normal event */ },\n  "integrity": {\n    "signature": "sha256:abc123...",\n    "previous_signature": "sha256:xyz789...",\n    "sequence_number": 12345\n  }\n}\n'})}),"\n",(0,s.jsx)(n.h3,{id:"retention-policies",children:"Retention Policies"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"enterprise:\n  audit:\n    retention:\n      min_days: 365  # Minimum retention (compliance)\n      max_days: 2555  # Maximum retention (7 years)\n\n    # S3 lifecycle\n    lifecycle:\n      - days: 90\n        storage_class: STANDARD_IA\n      - days: 365\n        storage_class: GLACIER\n"})}),"\n",(0,s.jsx)(n.h2,{id:"searching-and-analysis",children:"Searching and Analysis"}),"\n",(0,s.jsx)(n.h3,{id:"structured-logging",children:"Structured Logging"}),"\n",(0,s.jsx)(n.p,{children:"All logs are JSON for easy parsing:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"# Find all failed backups\ncat audit.log | jq 'select(.event_type == \"backup.failed\")'\n\n# Find access denied for user\ncat audit.log | jq 'select(.event_type == \"access.denied\" and .actor.id == \"bob@company.com\")'\n\n# Count events by type\ncat audit.log | jq '.event_type' | sort | uniq -c\n"})}),"\n",(0,s.jsx)(n.h3,{id:"cloudwatch-insights",children:"CloudWatch Insights"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sql",children:'-- Failed operations in last 24 hours\nfields @timestamp, event_type, actor.id, details.error\n| filter event_type like /failed/\n| sort @timestamp desc\n| limit 100\n\n-- Access denied events\nfields @timestamp, actor.id, details.operation, details.resource\n| filter event_type = "access.denied"\n| sort @timestamp desc\n'})}),"\n",(0,s.jsx)(n.h3,{id:"elasticsearchopensearch",children:"Elasticsearch/OpenSearch"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\n  "query": {\n    "bool": {\n      "must": [\n        { "match": { "event_type": "restore.completed" } },\n        { "range": { "timestamp": { "gte": "now-7d" } } }\n      ]\n    }\n  },\n  "aggs": {\n    "by_user": {\n      "terms": { "field": "actor.id.keyword" }\n    }\n  }\n}\n'})}),"\n",(0,s.jsx)(n.h2,{id:"alerting",children:"Alerting"}),"\n",(0,s.jsx)(n.h3,{id:"alert-configuration",children:"Alert Configuration"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"enterprise:\n  audit:\n    alerts:\n      - name: backup-failure\n        condition: \"event_type == 'backup.failed'\"\n        severity: high\n        notify:\n          - type: slack\n            webhook: ${SLACK_WEBHOOK}\n          - type: pagerduty\n            routing_key: ${PAGERDUTY_KEY}\n\n      - name: access-denied-spike\n        condition: \"event_type == 'access.denied'\"\n        threshold: 10\n        window: 5m\n        severity: medium\n        notify:\n          - type: email\n            to: security@company.com\n\n      - name: unauthorized-restore\n        condition: \"event_type == 'restore.started' and context.environment == 'production'\"\n        severity: high\n        notify:\n          - type: slack\n            channel: \"#security-alerts\"\n"})}),"\n",(0,s.jsx)(n.h3,{id:"alert-integrations",children:"Alert Integrations"}),"\n",(0,s.jsx)(n.h4,{id:"slack",children:"Slack"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:'notify:\n  - type: slack\n    webhook: ${SLACK_WEBHOOK}\n    channel: "#kafka-alerts"\n    template: |\n      :warning: *{{ .event_type }}*\n      User: {{ .actor.id }}\n      Resource: {{ .resource.id }}\n      Time: {{ .timestamp }}\n'})}),"\n",(0,s.jsx)(n.h4,{id:"pagerduty",children:"PagerDuty"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:'notify:\n  - type: pagerduty\n    routing_key: ${PAGERDUTY_ROUTING_KEY}\n    severity: "{{ .severity }}"\n'})}),"\n",(0,s.jsx)(n.h4,{id:"email",children:"Email"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"notify:\n  - type: email\n    smtp_server: smtp.company.com:587\n    from: kafka-backup@company.com\n    to:\n      - ops@company.com\n      - security@company.com\n"})}),"\n",(0,s.jsx)(n.h2,{id:"kubernetes-configuration",children:"Kubernetes Configuration"}),"\n",(0,s.jsx)(n.h3,{id:"configmap-for-audit-config",children:"ConfigMap for Audit Config"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"apiVersion: v1\nkind: ConfigMap\nmetadata:\n  name: audit-config\n  namespace: kafka-backup\ndata:\n  audit.yaml: |\n    enterprise:\n      audit:\n        enabled: true\n        destination:\n          type: s3\n          bucket: audit-logs\n        events:\n          - backup.*\n          - restore.*\n          - access.denied\n"})}),"\n",(0,s.jsx)(n.h3,{id:"volume-mount-for-file-logging",children:"Volume Mount for File Logging"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"apiVersion: kafka.oso.sh/v1alpha1\nkind: KafkaBackup\nmetadata:\n  name: audited-backup\nspec:\n  enterprise:\n    audit:\n      enabled: true\n      destination:\n        type: file\n        path: /var/log/audit/kafka-backup.log\n\n  # Mount persistent volume for audit logs\n  volumes:\n    - name: audit-logs\n      persistentVolumeClaim:\n        claimName: audit-logs-pvc\n  volumeMounts:\n    - name: audit-logs\n      mountPath: /var/log/audit\n"})}),"\n",(0,s.jsx)(n.h2,{id:"best-practices",children:"Best Practices"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Log to multiple destinations"})," - Redundancy for compliance"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Enable immutable storage"})," - Prevent tampering"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Set appropriate retention"})," - Meet compliance requirements"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Alert on security events"})," - Real-time monitoring"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Regular log review"})," - Periodic audit reviews"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Secure log access"})," - Limit who can read logs"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Include correlation IDs"})," - Trace requests across systems"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"sample-compliance-report",children:"Sample Compliance Report"}),"\n",(0,s.jsx)(n.p,{children:"Generate compliance reports from audit logs:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:'#!/bin/bash\n# Monthly compliance report\n\nSTART_DATE=$(date -d "last month" +%Y-%m-01)\nEND_DATE=$(date -d "this month" +%Y-%m-01)\n\necho "=== Kafka Backup Audit Report ==="\necho "Period: $START_DATE to $END_DATE"\necho ""\n\necho "Backup Operations:"\ncat audit.log | jq -r "select(.timestamp >= \\"$START_DATE\\" and .timestamp < \\"$END_DATE\\" and .event_type | startswith(\\"backup\\")) | .event_type" | sort | uniq -c\n\necho ""\necho "Restore Operations:"\ncat audit.log | jq -r "select(.timestamp >= \\"$START_DATE\\" and .timestamp < \\"$END_DATE\\" and .event_type | startswith(\\"restore\\")) | .event_type" | sort | uniq -c\n\necho ""\necho "Access Denied Events:"\ncat audit.log | jq -r "select(.timestamp >= \\"$START_DATE\\" and .timestamp < \\"$END_DATE\\" and .event_type == \\"access.denied\\") | \\"\\(.actor.id) - \\(.details.operation) - \\(.details.resource)\\""\n'})}),"\n",(0,s.jsx)(n.h2,{id:"next-steps",children:"Next Steps"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"./rbac",children:"RBAC Configuration"})," - Access control"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"../use-cases/compliance-audit",children:"Compliance Guide"})," - Meeting regulations"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"../guides/security-setup",children:"Security Setup"})," - Secure configuration"]}),"\n"]})]})}function u(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(o,{...e})}):o(e)}}}]);