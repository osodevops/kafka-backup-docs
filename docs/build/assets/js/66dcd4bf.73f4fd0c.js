"use strict";(globalThis.webpackChunkkafka_backup_docs=globalThis.webpackChunkkafka_backup_docs||[]).push([[9824],{6554:(e,n,a)=>{a.r(n),a.d(n,{assets:()=>s,contentTitle:()=>l,default:()=>d,frontMatter:()=>t,metadata:()=>r,toc:()=>c});const r=JSON.parse('{"id":"operator/configuration","title":"Configuration","description":"Configure the OSO Kafka Backup Operator","source":"@site/docs/operator/configuration.md","sourceDirName":"operator","slug":"/operator/configuration","permalink":"/operator/configuration","draft":false,"unlisted":false,"editUrl":"https://github.com/osodevops/kafka-backup-docs/tree/main/docs/docs/operator/configuration.md","tags":[],"version":"current","sidebarPosition":3,"frontMatter":{"title":"Configuration","description":"Configure the OSO Kafka Backup Operator","sidebar_position":3},"sidebar":"docsSidebar","previous":{"title":"Installation","permalink":"/operator/installation"},"next":{"title":"KafkaBackup","permalink":"/operator/crds/kafkabackup"}}');var i=a(4848),o=a(8453);const t={title:"Configuration",description:"Configure the OSO Kafka Backup Operator",sidebar_position:3},l="Configuration",s={},c=[{value:"Helm Values Reference",id:"helm-values-reference",level:2},{value:"Complete Values File",id:"complete-values-file",level:3},{value:"Configuration Sections",id:"configuration-sections",level:2},{value:"Operator Replicas",id:"operator-replicas",level:3},{value:"Image Configuration",id:"image-configuration",level:3},{value:"Resource Management",id:"resource-management",level:3},{value:"Service Account",id:"service-account",level:3},{value:"Security",id:"security",level:3},{value:"Metrics and Monitoring",id:"metrics-and-monitoring",level:3},{value:"Logging",id:"logging",level:3},{value:"Health Probes",id:"health-probes",level:3},{value:"Pod Scheduling",id:"pod-scheduling",level:3},{value:"Extra Mounts",id:"extra-mounts",level:3},{value:"Environment-Specific Configurations",id:"environment-specific-configurations",level:2},{value:"Development",id:"development",level:3},{value:"Production",id:"production",level:3},{value:"Air-Gapped",id:"air-gapped",level:3},{value:"Applying Configuration",id:"applying-configuration",level:2},{value:"Installation",id:"installation",level:3},{value:"Upgrade",id:"upgrade",level:3},{value:"View Current Values",id:"view-current-values",level:3},{value:"View All Values (including defaults)",id:"view-all-values-including-defaults",level:3},{value:"Configuration Validation",id:"configuration-validation",level:2},{value:"Dry Run",id:"dry-run",level:3},{value:"Template Output",id:"template-output",level:3},{value:"Next Steps",id:"next-steps",level:2}];function u(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,o.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"configuration",children:"Configuration"})}),"\n",(0,i.jsx)(n.p,{children:"Configure the OSO Kafka Backup Operator using Helm values."}),"\n",(0,i.jsx)(n.h2,{id:"helm-values-reference",children:"Helm Values Reference"}),"\n",(0,i.jsx)(n.h3,{id:"complete-values-file",children:"Complete Values File"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",metastring:'title="values.yaml"',children:'# Replica count for HA\nreplicaCount: 1\n\n# Image configuration\nimage:\n  repository: osodevops/kafka-backup-operator\n  tag: ""  # Defaults to chart appVersion\n  pullPolicy: IfNotPresent\n\n# Image pull secrets\nimagePullSecrets: []\n  # - name: my-registry-secret\n\n# Override names\nnameOverride: ""\nfullnameOverride: ""\n\n# Service account configuration\nserviceAccount:\n  create: true\n  annotations: {}\n    # eks.amazonaws.com/role-arn: arn:aws:iam::123456789:role/kafka-backup\n  name: ""  # Defaults to release name\n\n# Pod annotations\npodAnnotations: {}\n  # prometheus.io/scrape: "true"\n  # prometheus.io/port: "8080"\n\n# Pod security context\npodSecurityContext:\n  runAsNonRoot: true\n  runAsUser: 1000\n  fsGroup: 1000\n\n# Container security context\nsecurityContext:\n  allowPrivilegeEscalation: false\n  readOnlyRootFilesystem: true\n  capabilities:\n    drop:\n      - ALL\n\n# Resource limits\nresources:\n  requests:\n    cpu: 100m\n    memory: 128Mi\n  limits:\n    cpu: 500m\n    memory: 512Mi\n\n# Node selector\nnodeSelector: {}\n  # kubernetes.io/os: linux\n\n# Tolerations\ntolerations: []\n  # - key: "dedicated"\n  #   operator: "Equal"\n  #   value: "kafka-backup"\n  #   effect: "NoSchedule"\n\n# Affinity rules\naffinity: {}\n  # podAntiAffinity:\n  #   preferredDuringSchedulingIgnoredDuringExecution:\n  #     - weight: 100\n  #       podAffinityTerm:\n  #         labelSelector:\n  #           matchLabels:\n  #             app.kubernetes.io/name: kafka-backup-operator\n  #         topologyKey: kubernetes.io/hostname\n\n# CRD configuration\ncrds:\n  install: true\n  keep: false  # Keep CRDs on uninstall\n\n# Leader election for HA\nleaderElection:\n  enabled: true\n  leaseDuration: 15s\n  renewDeadline: 10s\n  retryPeriod: 2s\n\n# Metrics configuration\nmetrics:\n  enabled: true\n  port: 8080\n  path: /metrics\n\n  # Prometheus ServiceMonitor\n  serviceMonitor:\n    enabled: false\n    namespace: ""  # Defaults to release namespace\n    interval: 30s\n    scrapeTimeout: 10s\n    labels: {}\n      # release: prometheus\n\n# Health probes\nhealth:\n  livenessProbe:\n    httpGet:\n      path: /healthz\n      port: 8081\n    initialDelaySeconds: 15\n    periodSeconds: 20\n  readinessProbe:\n    httpGet:\n      path: /readyz\n      port: 8081\n    initialDelaySeconds: 5\n    periodSeconds: 10\n\n# Logging configuration\nlogging:\n  level: info  # debug, info, warn, error\n  format: json  # json or text\n\n# Pod disruption budget\npodDisruptionBudget:\n  enabled: false\n  minAvailable: 1\n  # maxUnavailable: 1\n\n# Network policy\nnetworkPolicy:\n  enabled: false\n  # ingress:\n  #   - from:\n  #       - namespaceSelector:\n  #           matchLabels:\n  #             name: monitoring\n\n# Extra environment variables\nenv: []\n  # - name: RUST_LOG\n  #   value: "debug"\n\n# Extra volumes\nextraVolumes: []\n  # - name: certs\n  #   secret:\n  #     secretName: kafka-tls\n\n# Extra volume mounts\nextraVolumeMounts: []\n  # - name: certs\n  #   mountPath: /certs\n  #   readOnly: true\n'})}),"\n",(0,i.jsx)(n.h2,{id:"configuration-sections",children:"Configuration Sections"}),"\n",(0,i.jsx)(n.h3,{id:"operator-replicas",children:"Operator Replicas"}),"\n",(0,i.jsx)(n.p,{children:"For high availability:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:"replicaCount: 2\n\nleaderElection:\n  enabled: true  # Required for multiple replicas\n"})}),"\n",(0,i.jsx)(n.h3,{id:"image-configuration",children:"Image Configuration"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:'image:\n  repository: osodevops/kafka-backup-operator\n  tag: "1.0.0"  # Specific version\n  pullPolicy: IfNotPresent\n\n# For private registries\nimagePullSecrets:\n  - name: my-registry-secret\n'})}),"\n",(0,i.jsx)(n.h3,{id:"resource-management",children:"Resource Management"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:"resources:\n  requests:\n    cpu: 100m\n    memory: 128Mi\n  limits:\n    cpu: 500m\n    memory: 512Mi\n"})}),"\n",(0,i.jsx)(n.p,{children:"Guidelines:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Memory: 128Mi minimum, 512Mi recommended"}),"\n",(0,i.jsx)(n.li,{children:"CPU: 100m minimum, scale based on backup frequency"}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"service-account",children:"Service Account"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:"serviceAccount:\n  create: true\n  name: kafka-backup-operator\n\n  # AWS IRSA\n  annotations:\n    eks.amazonaws.com/role-arn: arn:aws:iam::123456789:role/kafka-backup\n\n  # Azure Workload Identity\n  annotations:\n    azure.workload.identity/client-id: <client-id>\n\n  # GCP Workload Identity\n  annotations:\n    iam.gke.io/gcp-service-account: kafka-backup@project.iam.gserviceaccount.com\n"})}),"\n",(0,i.jsx)(n.h3,{id:"security",children:"Security"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:"podSecurityContext:\n  runAsNonRoot: true\n  runAsUser: 1000\n  fsGroup: 1000\n\nsecurityContext:\n  allowPrivilegeEscalation: false\n  readOnlyRootFilesystem: true\n  capabilities:\n    drop:\n      - ALL\n"})}),"\n",(0,i.jsx)(n.h3,{id:"metrics-and-monitoring",children:"Metrics and Monitoring"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:"metrics:\n  enabled: true\n  port: 8080\n  path: /metrics\n\n  serviceMonitor:\n    enabled: true\n    namespace: monitoring\n    interval: 30s\n    labels:\n      release: prometheus\n"})}),"\n",(0,i.jsx)(n.h3,{id:"logging",children:"Logging"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:'logging:\n  level: info   # debug for troubleshooting\n  format: json  # json recommended for log aggregation\n\n# Or via environment variable\nenv:\n  - name: RUST_LOG\n    value: "kafka_backup_operator=debug"\n'})}),"\n",(0,i.jsx)(n.h3,{id:"health-probes",children:"Health Probes"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:"health:\n  livenessProbe:\n    httpGet:\n      path: /healthz\n      port: 8081\n    initialDelaySeconds: 15\n    periodSeconds: 20\n    timeoutSeconds: 5\n    failureThreshold: 3\n\n  readinessProbe:\n    httpGet:\n      path: /readyz\n      port: 8081\n    initialDelaySeconds: 5\n    periodSeconds: 10\n    timeoutSeconds: 5\n    failureThreshold: 3\n"})}),"\n",(0,i.jsx)(n.h3,{id:"pod-scheduling",children:"Pod Scheduling"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:'nodeSelector:\n  kubernetes.io/os: linux\n  node-type: worker\n\ntolerations:\n  - key: "dedicated"\n    operator: "Equal"\n    value: "kafka-backup"\n    effect: "NoSchedule"\n\naffinity:\n  nodeAffinity:\n    requiredDuringSchedulingIgnoredDuringExecution:\n      nodeSelectorTerms:\n        - matchExpressions:\n            - key: node-type\n              operator: In\n              values:\n                - worker\n  podAntiAffinity:\n    preferredDuringSchedulingIgnoredDuringExecution:\n      - weight: 100\n        podAffinityTerm:\n          labelSelector:\n            matchLabels:\n              app.kubernetes.io/name: kafka-backup-operator\n          topologyKey: kubernetes.io/hostname\n'})}),"\n",(0,i.jsx)(n.h3,{id:"extra-mounts",children:"Extra Mounts"}),"\n",(0,i.jsx)(n.p,{children:"For TLS certificates or custom configuration:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:"extraVolumes:\n  - name: kafka-tls\n    secret:\n      secretName: kafka-tls-certs\n  - name: custom-config\n    configMap:\n      name: kafka-backup-config\n\nextraVolumeMounts:\n  - name: kafka-tls\n    mountPath: /certs/kafka\n    readOnly: true\n  - name: custom-config\n    mountPath: /config\n    readOnly: true\n"})}),"\n",(0,i.jsx)(n.h2,{id:"environment-specific-configurations",children:"Environment-Specific Configurations"}),"\n",(0,i.jsx)(n.h3,{id:"development",children:"Development"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",metastring:'title="values-dev.yaml"',children:"replicaCount: 1\n\nresources:\n  requests:\n    cpu: 50m\n    memory: 64Mi\n  limits:\n    cpu: 200m\n    memory: 256Mi\n\nlogging:\n  level: debug\n\nmetrics:\n  enabled: true\n  serviceMonitor:\n    enabled: false\n"})}),"\n",(0,i.jsx)(n.h3,{id:"production",children:"Production"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",metastring:'title="values-prod.yaml"',children:"replicaCount: 2\n\nresources:\n  requests:\n    cpu: 200m\n    memory: 256Mi\n  limits:\n    cpu: 1000m\n    memory: 1Gi\n\nlogging:\n  level: info\n\nmetrics:\n  enabled: true\n  serviceMonitor:\n    enabled: true\n    labels:\n      release: prometheus\n\npodDisruptionBudget:\n  enabled: true\n  minAvailable: 1\n\naffinity:\n  podAntiAffinity:\n    requiredDuringSchedulingIgnoredDuringExecution:\n      - labelSelector:\n          matchLabels:\n            app.kubernetes.io/name: kafka-backup-operator\n        topologyKey: kubernetes.io/hostname\n"})}),"\n",(0,i.jsx)(n.h3,{id:"air-gapped",children:"Air-Gapped"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",metastring:'title="values-airgapped.yaml"',children:"image:\n  repository: internal-registry.company.com/kafka-backup-operator\n  pullPolicy: Always\n\nimagePullSecrets:\n  - name: internal-registry-creds\n\n# Disable external endpoints\nmetrics:\n  serviceMonitor:\n    enabled: false\n"})}),"\n",(0,i.jsx)(n.h2,{id:"applying-configuration",children:"Applying Configuration"}),"\n",(0,i.jsx)(n.h3,{id:"installation",children:"Installation"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"helm install kafka-backup-operator oso/kafka-backup-operator \\\n  --namespace kafka-backup \\\n  --values values-prod.yaml\n"})}),"\n",(0,i.jsx)(n.h3,{id:"upgrade",children:"Upgrade"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"helm upgrade kafka-backup-operator oso/kafka-backup-operator \\\n  --namespace kafka-backup \\\n  --values values-prod.yaml\n"})}),"\n",(0,i.jsx)(n.h3,{id:"view-current-values",children:"View Current Values"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"helm get values kafka-backup-operator -n kafka-backup\n"})}),"\n",(0,i.jsx)(n.h3,{id:"view-all-values-including-defaults",children:"View All Values (including defaults)"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"helm get values kafka-backup-operator -n kafka-backup --all\n"})}),"\n",(0,i.jsx)(n.h2,{id:"configuration-validation",children:"Configuration Validation"}),"\n",(0,i.jsx)(n.h3,{id:"dry-run",children:"Dry Run"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"helm install kafka-backup-operator oso/kafka-backup-operator \\\n  --namespace kafka-backup \\\n  --values values.yaml \\\n  --dry-run\n"})}),"\n",(0,i.jsx)(n.h3,{id:"template-output",children:"Template Output"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"helm template kafka-backup-operator oso/kafka-backup-operator \\\n  --namespace kafka-backup \\\n  --values values.yaml\n"})}),"\n",(0,i.jsx)(n.h2,{id:"next-steps",children:"Next Steps"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"./metrics",children:"Metrics"})," - Prometheus metrics reference"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"./guides/secrets",children:"Secrets Guide"})," - Configure credentials"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"./crds/kafkabackup",children:"KafkaBackup CRD"})," - Create backups"]}),"\n"]})]})}function d(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(u,{...e})}):u(e)}},8453:(e,n,a)=>{a.d(n,{R:()=>t,x:()=>l});var r=a(6540);const i={},o=r.createContext(i);function t(e){const n=r.useContext(o);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:t(e.components),r.createElement(o.Provider,{value:n},e.children)}}}]);